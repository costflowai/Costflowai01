<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;">
    <title>Finish Carpentry Calculator - Trim & Detail | CostFlowAI</title>
    <meta name="description" content="Calculate finish carpentry costs, estimate trim materials, and plan detailed woodwork. Professional interior carpentry calculator.">
    <link rel="canonical" href="https://costflowai.com/calculators/finish-carpentry.html">
    <link rel="stylesheet" href="../assets/css/calculator.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <a href="../index.html">
                    <img src="../assets/images/logo.png" alt="CostFlow AI" class="logo">
                </a>
            </div>
            <nav class="nav">
                <a href="../index.html">Home</a>
                <a href="../calculators/index.html">Calculators</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="calc-container" id="finish-carpentry-calc" data-calc="finish-carpentry">
                <div class="calc-header">
                    <h1><i class="fas fa-hammer"></i> Finish Carpentry Calculator</h1>
                    <p>Crown molding, trim work, stairs, and custom millwork cost estimation</p>
                </div>

                <div class="calc-content">
                    <div class="input-section">
                        <div class="card">
                            <h3><i class="fas fa-ruler"></i> Room Dimensions</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="roomLength">Room Length (ft)</label>
                                    <input type="number" id="roomLength" value="16" min="1" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label for="roomWidth">Room Width (ft)</label>
                                    <input type="number" id="roomWidth" value="12" min="1" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label for="ceilingHeight">Ceiling Height (ft)</label>
                                    <input type="number" id="ceilingHeight" value="9" min="7" max="20" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label for="numberOfRooms">Number of Rooms</label>
                                    <input type="number" id="numberOfRooms" value="1" min="1" max="50">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-door-open"></i> Openings & Features</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="doors">Number of Doors</label>
                                    <input type="number" id="doors" value="2" min="0" max="20">
                                </div>
                                <div class="form-group">
                                    <label for="doorWidth">Average Door Width (ft)</label>
                                    <input type="number" id="doorWidth" value="3" min="2" max="12" step="0.1">
                                </div>
                                <div class="form-group">
                                    <label for="windows">Number of Windows</label>
                                    <input type="number" id="windows" value="3" min="0" max="30">
                                </div>
                                <div class="form-group">
                                    <label for="windowWidth">Average Window Width (ft)</label>
                                    <input type="number" id="windowWidth" value="4" min="1" max="12" step="0.1">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-cut"></i> Trim & Molding Selection</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="baseboard">Baseboard</label>
                                    <select id="baseboard">
                                        <option value="none">No Baseboard</option>
                                        <option value="basic-3.5" selected>Basic 3.5" MDF</option>
                                        <option value="colonial-4.5">Colonial 4.5" Pine</option>
                                        <option value="craftsman-5.5">Craftsman 5.5" Oak</option>
                                        <option value="premium-6">Premium 6" Hardwood</option>
                                        <option value="custom">Custom Profile</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="crownMolding">Crown Molding</label>
                                    <select id="crownMolding">
                                        <option value="none" selected>No Crown Molding</option>
                                        <option value="basic-3.5">Basic 3.5" MDF</option>
                                        <option value="traditional-4.5">Traditional 4.5" Pine</option>
                                        <option value="elaborate-5.5">Elaborate 5.5" Oak</option>
                                        <option value="coffered">Coffered Ceiling Detail</option>
                                        <option value="custom">Custom Design</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="casings">Door/Window Casings</label>
                                    <select id="casings">
                                        <option value="basic-2.25" selected>Basic 2.25" MDF</option>
                                        <option value="colonial-3.5">Colonial 3.5" Pine</option>
                                        <option value="craftsman-4.5">Craftsman 4.5" Oak</option>
                                        <option value="fluted">Fluted Casings</option>
                                        <option value="rosette">Rosette & Plinth Blocks</option>
                                        <option value="custom">Custom Millwork</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="chairRail">Chair Rail</label>
                                    <select id="chairRail">
                                        <option value="none" selected>No Chair Rail</option>
                                        <option value="basic-2.5">Basic 2.5" MDF</option>
                                        <option value="traditional-3">Traditional 3" Pine</option>
                                        <option value="beadboard">Beadboard Wainscoting</option>
                                        <option value="raised-panel">Raised Panel Wainscoting</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-stairs"></i> Stair Work</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="staircase">Staircase Type</label>
                                    <select id="staircase">
                                        <option value="none" selected>No Staircase</option>
                                        <option value="basic-straight">Basic Straight Stair</option>
                                        <option value="l-shaped">L-Shaped Stair</option>
                                        <option value="u-shaped">U-Shaped Stair</option>
                                        <option value="curved">Curved/Spiral Stair</option>
                                        <option value="floating">Floating Stairs</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="stairRisers">Number of Risers</label>
                                    <input type="number" id="stairRisers" value="0" min="0" max="30">
                                </div>
                                <div class="form-group">
                                    <label for="handrail">Handrail Style</label>
                                    <select id="handrail">
                                        <option value="none" selected>No Handrail</option>
                                        <option value="basic-pine">Basic Pine Rail</option>
                                        <option value="oak-traditional">Oak Traditional</option>
                                        <option value="mahogany">Mahogany Premium</option>
                                        <option value="metal-wood">Metal & Wood Combo</option>
                                        <option value="custom">Custom Turned Rail</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="balusters">Baluster Style</label>
                                    <select id="balusters">
                                        <option value="none" selected>No Balusters</option>
                                        <option value="basic-spindles">Basic Wood Spindles</option>
                                        <option value="turned-oak">Turned Oak</option>
                                        <option value="iron-balusters">Iron Balusters</option>
                                        <option value="cable-rail">Cable Rail System</option>
                                        <option value="glass-panels">Glass Panels</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-tools"></i> Custom Work</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="builtIns">Built-in Features</label>
                                    <select id="builtIns">
                                        <option value="none" selected>No Built-ins</option>
                                        <option value="basic-shelving">Basic Shelving</option>
                                        <option value="entertainment-center">Entertainment Center</option>
                                        <option value="bookcases">Built-in Bookcases</option>
                                        <option value="window-seat">Window Seat w/ Storage</option>
                                        <option value="custom-cabinetry">Custom Cabinetry</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="builtInLinearFt">Built-in Linear Feet</label>
                                    <input type="number" id="builtInLinearFt" value="0" min="0" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label for="beamWork">Decorative Beams</label>
                                    <select id="beamWork">
                                        <option value="none" selected>No Beam Work</option>
                                        <option value="faux-beams">Faux Wood Beams</option>
                                        <option value="real-timber">Real Timber Beams</option>
                                        <option value="box-beams">Box Beam Construction</option>
                                        <option value="coffered-ceiling">Coffered Ceiling</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="beamLinearFt">Beam Linear Feet</label>
                                    <input type="number" id="beamLinearFt" value="0" min="0" step="0.5">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-dollar-sign"></i> Labor & Material Costs</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="laborRate">Carpenter Rate ($/hour)</label>
                                    <input type="number" id="laborRate" value="65" min="25" max="150" step="5">
                                </div>
                                <div class="form-group">
                                    <label for="skillLevel">Skill Level Required</label>
                                    <select id="skillLevel">
                                        <option value="basic">Basic Carpentry</option>
                                        <option value="intermediate" selected>Intermediate</option>
                                        <option value="advanced">Advanced Finish Work</option>
                                        <option value="master">Master Craftsman</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="materialMarkup">Material Markup (%)</label>
                                    <input type="number" id="materialMarkup" value="20" min="0" max="100" step="5">
                                </div>
                                <div class="form-group">
                                    <label for="wasteFactor">Waste Factor (%)</label>
                                    <input type="number" id="wasteFactor" value="15" min="5" max="30" step="5">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="results-section">
                        <div class="card">
                            <h3><i class="fas fa-ruler-horizontal"></i> Material Quantities</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Baseboard Linear Feet:</span>
                                    <span class="value" id="baseboardLF">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Crown Molding Linear Feet:</span>
                                    <span class="value" id="crownMoldingLF">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Casing Linear Feet:</span>
                                    <span class="value" id="casingLF">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Chair Rail Linear Feet:</span>
                                    <span class="value" id="chairRailLF">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-clock"></i> Labor Analysis</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Installation Hours:</span>
                                    <span class="value" id="installationHours">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Complexity Multiplier:</span>
                                    <span class="value" id="complexityMultiplier">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Total Labor Hours:</span>
                                    <span class="value" id="totalLaborHours">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Project Duration:</span>
                                    <span class="value" id="projectDuration">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-list-alt"></i> Detailed Breakdown</h3>
                            <div id="materialBreakdown" class="material-list">
                                <!-- Material breakdown will be populated here -->
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-calculator"></i> Cost Summary</h3>
                            <div class="cost-breakdown">
                                <div class="cost-row">
                                    <span>Trim Materials:</span>
                                    <span id="trimMaterialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Stair Components:</span>
                                    <span id="stairMaterialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Built-in Materials:</span>
                                    <span id="builtInMaterialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Hardware & Fasteners:</span>
                                    <span id="hardwareCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Material Subtotal:</span>
                                    <span id="materialSubtotal">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Markup (<span id="markupPercent">20</span>%):</span>
                                    <span id="markupCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Waste (<span id="wastePercent">15</span>%):</span>
                                    <span id="wasteCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Total Materials:</span>
                                    <span id="totalMaterialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Labor Cost:</span>
                                    <span id="totalLaborCost">$0</span>
                                </div>
                                <div class="cost-row total">
                                    <span>Total Project Cost:</span>
                                    <span id="totalProjectCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Cost per Linear Foot:</span>
                                    <span id="costPerLF">$0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calc-actions">
                    <button data-action="save"><i class="fas fa-save"></i> Save</button>
                    <button data-action="export"><i class="fas fa-download"></i> Export CSV</button>
                    <button><i class="fas fa-share"></i> Share Link</button>
                    <button data-action="print"><i class="fas fa-print"></i> Print</button>
                </div>

                <div class="methodology-section">
                    <div class="card">
                        <h3><i class="fas fa-info-circle"></i> Calculation Methodology</h3>
                        <div class="methodology-content">
                            <h4>Linear Foot Calculations:</h4>
                            <p>• Baseboard: Room perimeter minus door openings plus inside/outside corners</p>
                            <p>• Crown molding: Room perimeter with miter allowances and corner treatments</p>
                            <p>• Casings: Door and window perimeters with header allowances</p>
                            
                            <h4>Labor Time Estimates:</h4>
                            <p>• Based on industry standards (RSMeans, NAHB)</p>
                            <p>• Complexity adjustments for skill level and detail work</p>
                            <p>• Installation rates: 8-12 LF/hour basic, 4-6 LF/hour complex</p>
                            
                            <h4>Material Costs:</h4>
                            <p>• Pricing based on regional lumber and millwork costs</p>
                            <p>• Waste factors account for cuts, miters, and defects</p>
                            <p>• Hardware includes fasteners, glue, and finishing supplies</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 CostFlow AI. Professional construction cost analysis.</p>
        </div>
    </footer>

    <script src="../assets/js/calculator-core.js"></script>
    <script src="/assets/js/calculators.js" defer></script>
    <script src="/assets/js/export-utilities.js" defer></script>
    <script src="/assets/js/calculators-hub.js" defer></script>
    <script>
        class FinishCarpentryCalculator extends ProCalculator {
            constructor() {
                super('Finish Carpentry Calculator');
                this.initializeCalculator();
            }

            initializeCalculator() {
                const inputs = [
                    'roomLength', 'roomWidth', 'ceilingHeight', 'numberOfRooms',
                    'doors', 'doorWidth', 'windows', 'windowWidth',
                    'baseboard', 'crownMolding', 'casings', 'chairRail',
                    'staircase', 'stairRisers', 'handrail', 'balusters',
                    'builtIns', 'builtInLinearFt', 'beamWork', 'beamLinearFt',
                    'laborRate', 'skillLevel', 'materialMarkup', 'wasteFactor'
                ];

                inputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('input', () => this.calculate());
                        element.addEventListener('change', () => this.calculate());
                    }
                });

                this.loadFromURL();
                this.calculate();
            }

            calculate() {
                this.collectInputs();
                this.calculateQuantities();
                this.calculateMaterialCosts();
                this.calculateLaborCosts();
                this.displayResults();
                this.updateInputs();
            }

            collectInputs() {
                this.inputs = {
                    roomLength: parseFloat(document.getElementById('roomLength').value) || 16,
                    roomWidth: parseFloat(document.getElementById('roomWidth').value) || 12,
                    ceilingHeight: parseFloat(document.getElementById('ceilingHeight').value) || 9,
                    numberOfRooms: parseInt(document.getElementById('numberOfRooms').value) || 1,
                    doors: parseInt(document.getElementById('doors').value) || 2,
                    doorWidth: parseFloat(document.getElementById('doorWidth').value) || 3,
                    windows: parseInt(document.getElementById('windows').value) || 3,
                    windowWidth: parseFloat(document.getElementById('windowWidth').value) || 4,
                    baseboard: document.getElementById('baseboard').value || 'basic-3.5',
                    crownMolding: document.getElementById('crownMolding').value || 'none',
                    casings: document.getElementById('casings').value || 'basic-2.25',
                    chairRail: document.getElementById('chairRail').value || 'none',
                    staircase: document.getElementById('staircase').value || 'none',
                    stairRisers: parseInt(document.getElementById('stairRisers').value) || 0,
                    handrail: document.getElementById('handrail').value || 'none',
                    balusters: document.getElementById('balusters').value || 'none',
                    builtIns: document.getElementById('builtIns').value || 'none',
                    builtInLinearFt: parseFloat(document.getElementById('builtInLinearFt').value) || 0,
                    beamWork: document.getElementById('beamWork').value || 'none',
                    beamLinearFt: parseFloat(document.getElementById('beamLinearFt').value) || 0,
                    laborRate: parseFloat(document.getElementById('laborRate').value) || 65,
                    skillLevel: document.getElementById('skillLevel').value || 'intermediate',
                    materialMarkup: parseFloat(document.getElementById('materialMarkup').value) || 20,
                    wasteFactor: parseFloat(document.getElementById('wasteFactor').value) || 15
                };
            }

            calculateQuantities() {
                const { roomLength, roomWidth, numberOfRooms, doors, doorWidth, windows, windowWidth, ceilingHeight } = this.inputs;
                
                // Room perimeter
                const roomPerimeter = 2 * (roomLength + roomWidth);
                const totalPerimeter = roomPerimeter * numberOfRooms;
                
                // Door and window openings
                const totalDoorWidth = doors * doorWidth;
                const totalWindowWidth = windows * windowWidth;
                const totalOpenings = totalDoorWidth + totalWindowWidth;
                
                // Baseboard calculation
                if (this.inputs.baseboard !== 'none') {
                    this.results.baseboardLF = totalPerimeter - totalDoorWidth; // Doors go to floor
                    this.results.baseboardLF += numberOfRooms * 4 * 0.5; // Corner allowances
                } else {
                    this.results.baseboardLF = 0;
                }
                
                // Crown molding calculation
                if (this.inputs.crownMolding !== 'none') {
                    this.results.crownMoldingLF = totalPerimeter;
                    this.results.crownMoldingLF += numberOfRooms * 4 * 0.75; // Miter allowances
                } else {
                    this.results.crownMoldingLF = 0;
                }
                
                // Casing calculation (doors and windows)
                const doorCasingLF = doors * ((2 * ceilingHeight) + doorWidth + 1); // Sides + header + allowance
                const windowCasingLF = windows * ((2 * 4) + windowWidth + 1); // Assume 4ft window height
                this.results.casingLF = doorCasingLF + windowCasingLF;
                
                // Chair rail calculation
                if (this.inputs.chairRail !== 'none') {
                    this.results.chairRailLF = totalPerimeter - totalOpenings * 0.5; // Reduced for openings
                } else {
                    this.results.chairRailLF = 0;
                }
                
                // Stair quantities
                if (this.inputs.staircase !== 'none' && this.inputs.stairRisers > 0) {
                    this.results.stairTreads = this.inputs.stairRisers - 1;
                    this.results.stairRisersCount = this.inputs.stairRisers;
                    this.results.handrailLF = this.calculateHandrailLength();
                    this.results.balusterCount = this.calculateBalusterCount();
                } else {
                    this.results.stairTreads = 0;
                    this.results.stairRisersCount = 0;
                    this.results.handrailLF = 0;
                    this.results.balusterCount = 0;
                }
                
                // Total linear feet for cost calculation
                this.results.totalLinearFeet = this.results.baseboardLF + this.results.crownMoldingLF + 
                    this.results.casingLF + this.results.chairRailLF + this.results.handrailLF + 
                    this.inputs.builtInLinearFt + this.inputs.beamLinearFt;
            }

            calculateHandrailLength() {
                const { stairRisers } = this.inputs;
                const avgTreadDepth = 10 / 12; // 10 inches in feet
                const avgRiserHeight = 7.5 / 12; // 7.5 inches in feet
                
                const totalRun = (stairRisers - 1) * avgTreadDepth;
                const totalRise = stairRisers * avgRiserHeight;
                
                // Handrail follows stair angle plus extensions
                const handrailLength = Math.sqrt(totalRun * totalRun + totalRise * totalRise) + 2; // 2ft extensions
                
                return handrailLength;
            }

            calculateBalusterCount() {
                const handrailLength = this.results.handrailLF || this.calculateHandrailLength();
                // Typically 2 balusters per tread at 16" OC
                return Math.ceil(handrailLength * 12 / 8) + 2; // Plus newel posts
            }

            calculateMaterialCosts() {
                // Material cost database (per linear foot)
                const materialCosts = {
                    baseboard: {
                        'none': 0,
                        'basic-3.5': 2.25,
                        'colonial-4.5': 3.50,
                        'craftsman-5.5': 5.75,
                        'premium-6': 8.50,
                        'custom': 12.00
                    },
                    crownMolding: {
                        'none': 0,
                        'basic-3.5': 3.50,
                        'traditional-4.5': 5.25,
                        'elaborate-5.5': 8.75,
                        'coffered': 25.00,
                        'custom': 18.00
                    },
                    casings: {
                        'basic-2.25': 2.75,
                        'colonial-3.5': 4.25,
                        'craftsman-4.5': 6.50,
                        'fluted': 9.75,
                        'rosette': 12.50,
                        'custom': 15.00
                    },
                    chairRail: {
                        'none': 0,
                        'basic-2.5': 3.25,
                        'traditional-3': 4.75,
                        'beadboard': 8.50,
                        'raised-panel': 15.00
                    },
                    handrail: {
                        'none': 0,
                        'basic-pine': 8.50,
                        'oak-traditional': 15.00,
                        'mahogany': 25.00,
                        'metal-wood': 35.00,
                        'custom': 45.00
                    },
                    balusters: {
                        'none': 0,
                        'basic-spindles': 12.00, // per baluster
                        'turned-oak': 18.00,
                        'iron-balusters': 25.00,
                        'cable-rail': 85.00,
                        'glass-panels': 150.00
                    }
                };
                
                // Calculate material costs
                this.results.trimMaterialsCost = 
                    (this.results.baseboardLF * (materialCosts.baseboard[this.inputs.baseboard] || 0)) +
                    (this.results.crownMoldingLF * (materialCosts.crownMolding[this.inputs.crownMolding] || 0)) +
                    (this.results.casingLF * (materialCosts.casings[this.inputs.casings] || 0)) +
                    (this.results.chairRailLF * (materialCosts.chairRail[this.inputs.chairRail] || 0));
                
                // Stair materials
                const stairMaterialCosts = {
                    'none': 0,
                    'basic-straight': 150,
                    'l-shaped': 350,
                    'u-shaped': 500,
                    'curved': 1200,
                    'floating': 800
                };
                
                const handrailCost = this.results.handrailLF * (materialCosts.handrail[this.inputs.handrail] || 0);
                const balusterCost = this.results.balusterCount * (materialCosts.balusters[this.inputs.balusters] || 0);
                const stairStructureCost = stairMaterialCosts[this.inputs.staircase] || 0;
                
                this.results.stairMaterialsCost = handrailCost + balusterCost + stairStructureCost;
                
                // Built-in materials
                const builtInCosts = {
                    'none': 0,
                    'basic-shelving': 25,
                    'entertainment-center': 85,
                    'bookcases': 65,
                    'window-seat': 95,
                    'custom-cabinetry': 150
                };
                
                this.results.builtInMaterialsCost = this.inputs.builtInLinearFt * (builtInCosts[this.inputs.builtIns] || 0);
                
                // Beam work
                const beamCosts = {
                    'none': 0,
                    'faux-beams': 15,
                    'real-timber': 35,
                    'box-beams': 25,
                    'coffered-ceiling': 85
                };
                
                this.results.beamMaterialsCost = this.inputs.beamLinearFt * (beamCosts[this.inputs.beamWork] || 0);
                
                // Hardware and fasteners (percentage of material cost)
                this.results.materialSubtotal = this.results.trimMaterialsCost + this.results.stairMaterialsCost + 
                    this.results.builtInMaterialsCost + this.results.beamMaterialsCost;
                    
                this.results.hardwareCost = this.results.materialSubtotal * 0.12; // 12% for fasteners, glue, etc.
                
                this.results.materialSubtotal += this.results.hardwareCost;
                
                // Apply markup and waste
                this.results.markupCost = this.results.materialSubtotal * (this.inputs.materialMarkup / 100);
                this.results.wasteCost = this.results.materialSubtotal * (this.inputs.wasteFactor / 100);
                
                this.results.totalMaterialsCost = this.results.materialSubtotal + this.results.markupCost + this.results.wasteCost;
            }

            calculateLaborCosts() {
                // Labor time estimates (hours per linear foot or unit)
                const laborTimes = {
                    baseboard: 0.12, // hours per LF
                    crownMolding: 0.18,
                    casings: 0.25,
                    chairRail: 0.15,
                    handrail: 0.35,
                    balusters: 0.75, // hours per baluster
                    builtIns: 2.5, // hours per LF
                    beams: 1.2 // hours per LF
                };
                
                // Calculate installation hours
                this.results.baseInstallationHours = 
                    (this.results.baseboardLF * laborTimes.baseboard) +
                    (this.results.crownMoldingLF * laborTimes.crownMolding) +
                    (this.results.casingLF * laborTimes.casings) +
                    (this.results.chairRailLF * laborTimes.chairRail) +
                    (this.results.handrailLF * laborTimes.handrail) +
                    (this.results.balusterCount * laborTimes.balusters) +
                    (this.inputs.builtInLinearFt * laborTimes.builtIns) +
                    (this.inputs.beamLinearFt * laborTimes.beams);
                
                // Skill level complexity multipliers
                const complexityMultipliers = {
                    'basic': 0.85,
                    'intermediate': 1.0,
                    'advanced': 1.4,
                    'master': 1.8
                };
                
                this.results.complexityMultiplier = complexityMultipliers[this.inputs.skillLevel] || 1.0;
                this.results.totalLaborHours = this.results.baseInstallationHours * this.results.complexityMultiplier;
                
                // Add setup and cleanup time
                this.results.totalLaborHours += Math.max(4, this.results.totalLaborHours * 0.15);
                
                // Calculate labor cost
                this.results.totalLaborCost = this.results.totalLaborHours * this.inputs.laborRate;
                
                // Project duration (assuming 8 hours per day)
                this.results.projectDuration = Math.ceil(this.results.totalLaborHours / 8);
            }

            displayResults() {
                // Material Quantities
                document.getElementById('baseboardLF').textContent = `${this.results.baseboardLF.toFixed(1)} LF`;
                document.getElementById('crownMoldingLF').textContent = `${this.results.crownMoldingLF.toFixed(1)} LF`;
                document.getElementById('casingLF').textContent = `${this.results.casingLF.toFixed(1)} LF`;
                document.getElementById('chairRailLF').textContent = `${this.results.chairRailLF.toFixed(1)} LF`;
                
                // Labor Analysis
                document.getElementById('installationHours').textContent = `${this.results.baseInstallationHours.toFixed(1)} hrs`;
                document.getElementById('complexityMultiplier').textContent = `${this.results.complexityMultiplier}x`;
                document.getElementById('totalLaborHours').textContent = `${this.results.totalLaborHours.toFixed(1)} hrs`;
                document.getElementById('projectDuration').textContent = `${this.results.projectDuration} days`;
                
                // Material Breakdown
                this.displayMaterialBreakdown();
                
                // Costs
                document.getElementById('trimMaterialsCost').textContent = `$${this.results.trimMaterialsCost.toFixed(2)}`;
                document.getElementById('stairMaterialsCost').textContent = `$${this.results.stairMaterialsCost.toFixed(2)}`;
                document.getElementById('builtInMaterialsCost').textContent = `$${this.results.builtInMaterialsCost.toFixed(2)}`;
                document.getElementById('hardwareCost').textContent = `$${this.results.hardwareCost.toFixed(2)}`;
                document.getElementById('materialSubtotal').textContent = `$${this.results.materialSubtotal.toFixed(2)}`;
                document.getElementById('markupPercent').textContent = this.inputs.materialMarkup;
                document.getElementById('markupCost').textContent = `$${this.results.markupCost.toFixed(2)}`;
                document.getElementById('wastePercent').textContent = this.inputs.wasteFactor;
                document.getElementById('wasteCost').textContent = `$${this.results.wasteCost.toFixed(2)}`;
                document.getElementById('totalMaterialsCost').textContent = `$${this.results.totalMaterialsCost.toFixed(2)}`;
                document.getElementById('totalLaborCost').textContent = `$${this.results.totalLaborCost.toFixed(2)}`;
                
                this.results.totalProjectCost = this.results.totalMaterialsCost + this.results.totalLaborCost;
                document.getElementById('totalProjectCost').textContent = `$${this.results.totalProjectCost.toFixed(2)}`;
                
                const costPerLF = this.results.totalLinearFeet > 0 ? this.results.totalProjectCost / this.results.totalLinearFeet : 0;
                document.getElementById('costPerLF').textContent = `$${costPerLF.toFixed(2)}`;
            }

            displayMaterialBreakdown() {
                const breakdownDiv = document.getElementById('materialBreakdown');
                
                let html = '';
                
                if (this.results.baseboardLF > 0) {
                    html += `<div class="material-item">
                        <div class="material-description">
                            <strong>Baseboard (${this.inputs.baseboard.replace('-', ' ')})</strong>
                            <span>${this.results.baseboardLF.toFixed(1)} LF</span>
                        </div>
                        <div class="material-cost">$${(this.results.baseboardLF * this.getMaterialCost('baseboard')).toFixed(2)}</div>
                    </div>`;
                }
                
                if (this.results.crownMoldingLF > 0) {
                    html += `<div class="material-item">
                        <div class="material-description">
                            <strong>Crown Molding (${this.inputs.crownMolding.replace('-', ' ')})</strong>
                            <span>${this.results.crownMoldingLF.toFixed(1)} LF</span>
                        </div>
                        <div class="material-cost">$${(this.results.crownMoldingLF * this.getMaterialCost('crownMolding')).toFixed(2)}</div>
                    </div>`;
                }
                
                if (this.results.casingLF > 0) {
                    html += `<div class="material-item">
                        <div class="material-description">
                            <strong>Door/Window Casings (${this.inputs.casings.replace('-', ' ')})</strong>
                            <span>${this.results.casingLF.toFixed(1)} LF</span>
                        </div>
                        <div class="material-cost">$${(this.results.casingLF * this.getMaterialCost('casings')).toFixed(2)}</div>
                    </div>`;
                }
                
                if (this.inputs.staircase !== 'none') {
                    html += `<div class="material-item">
                        <div class="material-description">
                            <strong>Staircase (${this.inputs.staircase.replace('-', ' ')})</strong>
                            <span>${this.inputs.stairRisers} risers</span>
                        </div>
                        <div class="material-cost">$${this.results.stairMaterialsCost.toFixed(2)}</div>
                    </div>`;
                }
                
                if (this.inputs.builtInLinearFt > 0) {
                    html += `<div class="material-item">
                        <div class="material-description">
                            <strong>Built-ins (${this.inputs.builtIns.replace('-', ' ')})</strong>
                            <span>${this.inputs.builtInLinearFt} LF</span>
                        </div>
                        <div class="material-cost">$${this.results.builtInMaterialsCost.toFixed(2)}</div>
                    </div>`;
                }
                
                breakdownDiv.innerHTML = html;
            }

            getMaterialCost(type) {
                const costs = {
                    baseboard: {
                        'none': 0, 'basic-3.5': 2.25, 'colonial-4.5': 3.50, 'craftsman-5.5': 5.75, 'premium-6': 8.50, 'custom': 12.00
                    },
                    crownMolding: {
                        'none': 0, 'basic-3.5': 3.50, 'traditional-4.5': 5.25, 'elaborate-5.5': 8.75, 'coffered': 25.00, 'custom': 18.00
                    },
                    casings: {
                        'basic-2.25': 2.75, 'colonial-3.5': 4.25, 'craftsman-4.5': 6.50, 'fluted': 9.75, 'rosette': 12.50, 'custom': 15.00
                    }
                };
                
                return costs[type][this.inputs[type]] || 0;
            }

            printResults() {
                const printWindow = window.open('', '_blank');
                const printContent = `
                    <html>
                    <head>
                        <title>Finish Carpentry Results</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .header { text-align: center; margin-bottom: 30px; }
                            .section { margin-bottom: 20px; }
                            .section h3 { color: #2c5282; border-bottom: 2px solid #2c5282; padding-bottom: 5px; }
                            .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
                            .material-table { width: 100%; border-collapse: collapse; }
                            .material-table th, .material-table td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
                            .cost-summary { background: #f7fafc; padding: 15px; border-radius: 5px; }
                            .total-row { font-weight: bold; border-top: 2px solid #2c5282; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h2>Finish Carpentry Results</h2>
                            <p>Project: ${this.inputs.numberOfRooms} rooms (${this.inputs.roomLength}' x ${this.inputs.roomWidth}')</p>
                            <p>Generated: ${new Date().toLocaleDateString()}</p>
                        </div>
                        
                        <div class="section">
                            <h3>Material Quantities</h3>
                            <div class="grid">
                                <div>Baseboard: ${this.results.baseboardLF.toFixed(1)} LF</div>
                                <div>Crown Molding: ${this.results.crownMoldingLF.toFixed(1)} LF</div>
                                <div>Casings: ${this.results.casingLF.toFixed(1)} LF</div>
                                <div>Chair Rail: ${this.results.chairRailLF.toFixed(1)} LF</div>
                                <div>Total Linear Feet: ${this.results.totalLinearFeet.toFixed(1)} LF</div>
                                <div>Labor Hours: ${this.results.totalLaborHours.toFixed(1)} hrs</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Cost Summary</h3>
                            <div class="cost-summary">
                                <div>Materials: $${this.results.totalMaterialsCost.toFixed(2)}</div>
                                <div>Labor: $${this.results.totalLaborCost.toFixed(2)}</div>
                                <div class="total-row">Total Project Cost: $${this.results.totalProjectCost.toFixed(2)}</div>
                                <div>Cost per Linear Foot: $${(this.results.totalProjectCost / this.results.totalLinearFeet).toFixed(2)}</div>
                                <div>Project Duration: ${this.results.projectDuration} days</div>
                            </div>
                        </div>
                    <script defer>
    document.getElementById('btn-print')?.addEventListener('click', () => window.print());
</script>
</body>
                    </html>
                `;
                
                printWindow.document.write(printContent);
                printWindow.document.close();
                printWindow.print();
            }
        }

        // Initialize calculator
        const calculator = new FinishCarpentryCalculator();
    </script>
<script defer>
    document.getElementById('btn-print')?.addEventListener('click', () => window.print());
</script>
</body>
</html>