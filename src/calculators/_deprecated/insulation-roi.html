<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;">
    <title>Insulation ROI Calculator - Energy Savings | CostFlowAI</title>
    <meta name="description" content="Calculate insulation ROI, analyze energy savings, and compare insulation types. Professional energy efficiency investment calculator.">
    <link rel="canonical" href="https://costflowai.com/calculators/insulation-roi.html">
    <link rel="stylesheet" href="../assets/css/calculator.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header class="header">
        <div class="container">
            <div class="nav-brand">
                <a href="../index.html">
                    <img src="../assets/images/logo.png" alt="CostFlow AI" class="logo">
                </a>
            </div>
            <nav class="nav">
                <a href="../index.html">Home</a>
                <a href="../calculators/index.html">Calculators</a>
                <a href="../about.html">About</a>
                <a href="../contact.html">Contact</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="calc-container" id="insulation-calc" data-calc="insulation">
                <div class="calc-header">
                    <h1><i class="fas fa-thermometer-half"></i> Insulation ROI Calculator</h1>
                    <p>R-value optimization, energy savings analysis, and payback period calculations</p>
                </div>

                <div class="calc-content">
                    <div class="input-section">
                        <div class="card">
                            <h3><i class="fas fa-home"></i> Building Information</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="buildingArea">Building Area (sq ft)</label>
                                    <input type="number" id="buildingArea" value="2000" min="500" step="50">
                                </div>
                                <div class="form-group">
                                    <label for="buildingType">Building Type</label>
                                    <select id="buildingType">
                                        <option value="single-family" selected>Single Family Home</option>
                                        <option value="multi-family">Multi-Family</option>
                                        <option value="commercial-office">Commercial Office</option>
                                        <option value="retail">Retail</option>
                                        <option value="warehouse">Warehouse</option>
                                        <option value="manufacturing">Manufacturing</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="buildingAge">Building Age (years)</label>
                                    <input type="number" id="buildingAge" value="15" min="0" max="150">
                                </div>
                                <div class="form-group">
                                    <label for="climateZone">Climate Zone</label>
                                    <select id="climateZone">
                                        <option value="1">Zone 1 - Very Hot-Humid (Miami, Hawaii)</option>
                                        <option value="2">Zone 2 - Hot-Humid (Houston, Orlando)</option>
                                        <option value="3">Zone 3 - Warm-Humid (Atlanta, Memphis)</option>
                                        <option value="4" selected>Zone 4 - Mixed-Humid (DC, Kansas City)</option>
                                        <option value="5">Zone 5 - Cool-Humid (Chicago, Boston)</option>
                                        <option value="6">Zone 6 - Cold-Humid (Minneapolis, Buffalo)</option>
                                        <option value="7">Zone 7 - Very Cold (Duluth, Anchorage)</option>
                                        <option value="8">Zone 8 - Subarctic (Fairbanks)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-layer-group"></i> Current Insulation</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="currentRValue">Current R-Value</label>
                                    <input type="number" id="currentRValue" value="13" min="0" max="100" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label for="currentInsulationType">Current Insulation Type</label>
                                    <select id="currentInsulationType">
                                        <option value="none">No Insulation</option>
                                        <option value="fiberglass-batts" selected>Fiberglass Batts</option>
                                        <option value="blown-cellulose">Blown Cellulose</option>
                                        <option value="spray-foam-open">Spray Foam (Open Cell)</option>
                                        <option value="spray-foam-closed">Spray Foam (Closed Cell)</option>
                                        <option value="rigid-foam">Rigid Foam Board</option>
                                        <option value="mineral-wool">Mineral Wool</option>
                                        <option value="other">Other/Unknown</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="insulationCondition">Insulation Condition</label>
                                    <select id="insulationCondition">
                                        <option value="excellent">Excellent</option>
                                        <option value="good">Good</option>
                                        <option value="fair" selected>Fair</option>
                                        <option value="poor">Poor</option>
                                        <option value="deteriorated">Deteriorated</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="airLeakage">Air Leakage Level</label>
                                    <select id="airLeakage">
                                        <option value="tight">Very Tight (< 3 ACH50)</option>
                                        <option value="moderate">Moderate (3-7 ACH50)</option>
                                        <option value="leaky" selected>Leaky (7-15 ACH50)</option>
                                        <option value="very-leaky">Very Leaky (> 15 ACH50)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-plus-circle"></i> Proposed Upgrade</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="targetRValue">Target R-Value</label>
                                    <input type="number" id="targetRValue" value="38" min="1" max="100" step="0.5">
                                </div>
                                <div class="form-group">
                                    <label for="upgradeType">Upgrade Type</label>
                                    <select id="upgradeType">
                                        <option value="add-blown">Add Blown Insulation</option>
                                        <option value="replace-batts" selected>Replace with Batts</option>
                                        <option value="spray-foam-upgrade">Spray Foam Upgrade</option>
                                        <option value="rigid-foam-exterior">Exterior Rigid Foam</option>
                                        <option value="complete-retrofit">Complete Retrofit</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="newInsulationType">New Insulation Type</label>
                                    <select id="newInsulationType">
                                        <option value="fiberglass-batts" selected>Fiberglass Batts</option>
                                        <option value="blown-cellulose">Blown Cellulose</option>
                                        <option value="blown-fiberglass">Blown Fiberglass</option>
                                        <option value="spray-foam-open">Spray Foam (Open Cell)</option>
                                        <option value="spray-foam-closed">Spray Foam (Closed Cell)</option>
                                        <option value="rigid-foam-eps">Rigid EPS Foam</option>
                                        <option value="rigid-foam-xps">Rigid XPS Foam</option>
                                        <option value="rigid-foam-polyiso">Rigid Polyiso Foam</option>
                                        <option value="mineral-wool">Mineral Wool</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="installationMethod">Installation Method</label>
                                    <select id="installationMethod">
                                        <option value="diy" selected>DIY Installation</option>
                                        <option value="contractor">Professional Contractor</option>
                                        <option value="specialty">Specialty Contractor</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-bolt"></i> Energy Costs</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="heatingFuel">Primary Heating Fuel</label>
                                    <select id="heatingFuel">
                                        <option value="natural-gas" selected>Natural Gas</option>
                                        <option value="electricity">Electricity</option>
                                        <option value="propane">Propane</option>
                                        <option value="heating-oil">Heating Oil</option>
                                        <option value="heat-pump">Heat Pump</option>
                                        <option value="wood">Wood</option>
                                        <option value="other">Other</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="heatingCost">Heating Cost ($/unit)</label>
                                    <input type="number" id="heatingCost" value="1.20" min="0" step="0.01">
                                    <small id="heatingUnit">per therm</small>
                                </div>
                                <div class="form-group">
                                    <label for="coolingType">Cooling System</label>
                                    <select id="coolingType">
                                        <option value="central-ac" selected>Central Air Conditioning</option>
                                        <option value="heat-pump">Heat Pump</option>
                                        <option value="window-units">Window Units</option>
                                        <option value="evap-cooling">Evaporative Cooling</option>
                                        <option value="none">No Cooling</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="electricityRate">Electricity Rate ($/kWh)</label>
                                    <input type="number" id="electricityRate" value="0.13" min="0" step="0.001">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-dollar-sign"></i> Cost Factors</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="materialCostSqFt">Material Cost ($/sq ft)</label>
                                    <input type="number" id="materialCostSqFt" value="1.25" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="laborCostSqFt">Labor Cost ($/sq ft)</label>
                                    <input type="number" id="laborCostSqFt" value="1.85" min="0" step="0.01">
                                </div>
                                <div class="form-group">
                                    <label for="taxCredits">Tax Credits/Rebates ($)</label>
                                    <input type="number" id="taxCredits" value="0" min="0" step="50">
                                </div>
                                <div class="form-group">
                                    <label for="energyEscalation">Annual Energy Cost Increase (%)</label>
                                    <input type="number" id="energyEscalation" value="3.5" min="0" max="20" step="0.1">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="results-section">
                        <div class="card">
                            <h3><i class="fas fa-chart-line"></i> Energy Savings Analysis</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Current Annual Energy Cost:</span>
                                    <span class="value" id="currentAnnualCost">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Projected Annual Cost:</span>
                                    <span class="value" id="projectedAnnualCost">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Annual Savings:</span>
                                    <span class="value highlight" id="annualSavings">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Energy Reduction:</span>
                                    <span class="value" id="energyReduction">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-calculator"></i> Investment Analysis</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Total Project Cost:</span>
                                    <span class="value" id="totalProjectCost">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Net Cost After Incentives:</span>
                                    <span class="value" id="netProjectCost">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Simple Payback Period:</span>
                                    <span class="value highlight" id="paybackPeriod">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">20-Year ROI:</span>
                                    <span class="value" id="twentyYearROI">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-chart-area"></i> Cost Breakdown</h3>
                            <div class="cost-breakdown">
                                <div class="cost-row">
                                    <span>Materials:</span>
                                    <span id="materialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Labor:</span>
                                    <span id="laborCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Removal/Prep:</span>
                                    <span id="prepCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Equipment/Tools:</span>
                                    <span id="equipmentCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Permits/Inspection:</span>
                                    <span id="permitCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Subtotal:</span>
                                    <span id="subtotalCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Tax Credits/Rebates:</span>
                                    <span class="savings" id="incentivesSavings">-$0</span>
                                </div>
                                <div class="cost-row total">
                                    <span>Net Project Cost:</span>
                                    <span id="finalCost">$0</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-thermometer-three-quarters"></i> R-Value Recommendations</h3>
                            <div id="rValueRecommendations" class="recommendations">
                                <!-- R-value recommendations will be populated here -->
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-calendar-alt"></i> 20-Year Financial Projection</h3>
                            <div id="financialProjection" class="projection-chart">
                                <!-- Financial projection chart will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calc-actions">
                    <button type="button" class="btn btn-primary" data-action="calculate"><i class="fas fa-calculator"></i> Calculate ROI</button>
                    <button data-action="save"><i class="fas fa-save"></i> Save</button>
                    <button data-action="export"><i class="fas fa-download"></i> Export CSV</button>
                    <button data-action="share"><i class="fas fa-share"></i> Share Link</button>
                    <button data-action="print"><i class="fas fa-print"></i> Print</button>
                    <button data-action="email"><i class="fas fa-envelope"></i> Email Results</button>
                </div>

                <div class="methodology-section">
                    <div class="card">
                        <h3><i class="fas fa-info-circle"></i> Calculation Methodology</h3>
                        <div class="methodology-content">
                            <h4>Energy Calculations:</h4>
                            <p>• Heat loss calculated using Q = U × A × ΔT formula</p>
                            <p>• Degree days data from NOAA for climate zone accuracy</p>
                            <p>• HVAC efficiency factors based on equipment age and type</p>
                            
                            <h4>R-Value Analysis:</h4>
                            <p>• Total thermal resistance includes air films and building materials</p>
                            <p>• Thermal bridging effects calculated for framing members</p>
                            <p>• Air leakage impacts modeled using blower door test equivalents</p>
                            
                            <h4>Financial Analysis:</h4>
                            <p>• Simple payback = Net cost ÷ Annual savings</p>
                            <p>• NPV calculated with energy cost escalation rates</p>
                            <p>• Tax credits applied per current federal and state programs</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 CostFlow AI. Professional construction cost analysis.</p>
        </div>
    </footer>

    <script src="../assets/js/calculator-core.js" defer></script>
    <script src="/assets/js/calculators.js" defer></script>
    <script src="/assets/js/export-utilities.js" defer></script>
    <script src="/assets/js/calculators-hub.js" defer></script>
    <script>
        class InsulationROICalculator extends ProCalculator {
            constructor() {
                super('Insulation ROI Calculator');
                this.initializeCalculator();
            }

            initializeCalculator() {
                const inputs = [
                    'buildingArea', 'buildingType', 'buildingAge', 'climateZone',
                    'currentRValue', 'currentInsulationType', 'insulationCondition', 'airLeakage',
                    'targetRValue', 'upgradeType', 'newInsulationType', 'installationMethod',
                    'heatingFuel', 'heatingCost', 'coolingType', 'electricityRate',
                    'materialCostSqFt', 'laborCostSqFt', 'taxCredits', 'energyEscalation'
                ];

                inputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('input', () => this.calculate());
                        element.addEventListener('change', () => this.calculate());
                    }
                });

                // Update heating cost unit when fuel type changes
                document.getElementById('heatingFuel').addEventListener('change', () => {
                    this.updateHeatingUnit();
                    this.calculate();
                });

                // Update material/labor costs when insulation type changes
                document.getElementById('newInsulationType').addEventListener('change', () => {
                    this.updateInsulationCosts();
                    this.calculate();
                });

                this.loadFromURL();
                this.calculate();
            }

            updateHeatingUnit() {
                const fuelType = document.getElementById('heatingFuel').value;
                const unitElement = document.getElementById('heatingUnit');
                const costElement = document.getElementById('heatingCost');
                
                const fuelUnits = {
                    'natural-gas': { unit: 'per therm', defaultCost: 1.20 },
                    'electricity': { unit: 'per kWh', defaultCost: 0.13 },
                    'propane': { unit: 'per gallon', defaultCost: 2.50 },
                    'heating-oil': { unit: 'per gallon', defaultCost: 3.20 },
                    'heat-pump': { unit: 'per kWh', defaultCost: 0.13 },
                    'wood': { unit: 'per cord', defaultCost: 200 },
                    'other': { unit: 'per unit', defaultCost: 1.00 }
                };
                
                const fuelData = fuelUnits[fuelType] || fuelUnits['natural-gas'];
                unitElement.textContent = fuelData.unit;
                costElement.value = fuelData.defaultCost;
            }

            updateInsulationCosts() {
                const insulationType = document.getElementById('newInsulationType').value;
                
                const insulationCosts = {
                    'fiberglass-batts': { material: 1.25, labor: 1.85 },
                    'blown-cellulose': { material: 1.10, labor: 2.20 },
                    'blown-fiberglass': { material: 1.35, labor: 2.20 },
                    'spray-foam-open': { material: 3.50, labor: 2.50 },
                    'spray-foam-closed': { material: 5.25, labor: 3.00 },
                    'rigid-foam-eps': { material: 2.15, labor: 3.25 },
                    'rigid-foam-xps': { material: 2.85, labor: 3.25 },
                    'rigid-foam-polyiso': { material: 3.10, labor: 3.25 },
                    'mineral-wool': { material: 1.95, labor: 2.10 }
                };
                
                const costs = insulationCosts[insulationType] || insulationCosts['fiberglass-batts'];
                document.getElementById('materialCostSqFt').value = costs.material;
                document.getElementById('laborCostSqFt').value = costs.labor;
            }

            calculate() {
                this.collectInputs();
                this.calculateEnergyUse();
                this.calculateCosts();
                this.calculateSavings();
                this.calculateROI();
                this.displayResults();
                this.updateInputs();
            }

            collectInputs() {
                this.inputs = {
                    buildingArea: parseFloat(document.getElementById('buildingArea').value) || 2000,
                    buildingType: document.getElementById('buildingType').value || 'single-family',
                    buildingAge: parseInt(document.getElementById('buildingAge').value) || 15,
                    climateZone: parseInt(document.getElementById('climateZone').value) || 4,
                    currentRValue: parseFloat(document.getElementById('currentRValue').value) || 13,
                    currentInsulationType: document.getElementById('currentInsulationType').value || 'fiberglass-batts',
                    insulationCondition: document.getElementById('insulationCondition').value || 'fair',
                    airLeakage: document.getElementById('airLeakage').value || 'leaky',
                    targetRValue: parseFloat(document.getElementById('targetRValue').value) || 38,
                    upgradeType: document.getElementById('upgradeType').value || 'replace-batts',
                    newInsulationType: document.getElementById('newInsulationType').value || 'fiberglass-batts',
                    installationMethod: document.getElementById('installationMethod').value || 'diy',
                    heatingFuel: document.getElementById('heatingFuel').value || 'natural-gas',
                    heatingCost: parseFloat(document.getElementById('heatingCost').value) || 1.20,
                    coolingType: document.getElementById('coolingType').value || 'central-ac',
                    electricityRate: parseFloat(document.getElementById('electricityRate').value) || 0.13,
                    materialCostSqFt: parseFloat(document.getElementById('materialCostSqFt').value) || 1.25,
                    laborCostSqFt: parseFloat(document.getElementById('laborCostSqFt').value) || 1.85,
                    taxCredits: parseFloat(document.getElementById('taxCredits').value) || 0,
                    energyEscalation: parseFloat(document.getElementById('energyEscalation').value) || 3.5
                };
            }

            calculateEnergyUse() {
                // Climate zone degree days (heating/cooling)
                const degreedays = {
                    1: { heating: 500, cooling: 4000 },
                    2: { heating: 1500, cooling: 3000 },
                    3: { heating: 2500, cooling: 2000 },
                    4: { heating: 4000, cooling: 1500 },
                    5: { heating: 5500, cooling: 1000 },
                    6: { heating: 7000, cooling: 500 },
                    7: { heating: 9000, cooling: 200 },
                    8: { heating: 12000, cooling: 0 }
                };

                const climate = degreedays[this.inputs.climateZone] || degreedays[4];
                
                // Building envelope factors
                const envelopeFactors = {
                    'single-family': 0.75,
                    'multi-family': 0.65,
                    'commercial-office': 0.55,
                    'retail': 0.60,
                    'warehouse': 0.85,
                    'manufacturing': 0.90
                };

                const envelopeFactor = envelopeFactors[this.inputs.buildingType] || 0.75;
                
                // Air leakage multipliers
                const airLeakageFactors = {
                    'tight': 0.8,
                    'moderate': 1.0,
                    'leaky': 1.4,
                    'very-leaky': 1.8
                };
                
                const airLeakageFactor = airLeakageFactors[this.inputs.airLeakage] || 1.4;
                
                // Insulation condition factors
                const conditionFactors = {
                    'excellent': 1.0,
                    'good': 0.95,
                    'fair': 0.85,
                    'poor': 0.70,
                    'deteriorated': 0.50
                };
                
                const currentConditionFactor = conditionFactors[this.inputs.insulationCondition] || 0.85;
                
                // Calculate heat loss coefficient (Btu/hr/°F)
                const currentUValue = 1 / (this.inputs.currentRValue * currentConditionFactor);
                const targetUValue = 1 / this.inputs.targetRValue;
                
                // Annual energy use calculations
                const baseHeatLoss = this.inputs.buildingArea * envelopeFactor * 24 / 1000; // Base factor
                
                this.results.currentHeatingLoad = baseHeatLoss * currentUValue * climate.heating * airLeakageFactor;
                this.results.targetHeatingLoad = baseHeatLoss * targetUValue * climate.heating * airLeakageFactor * 0.9; // 10% improvement from air sealing
                
                this.results.currentCoolingLoad = baseHeatLoss * currentUValue * climate.cooling * 0.7; // Less impact on cooling
                this.results.targetCoolingLoad = baseHeatLoss * targetUValue * climate.cooling * 0.7;
                
                // Convert to actual energy costs
                const heatingEfficiency = this.getHeatingEfficiency();
                const coolingEfficiency = this.getCoolingEfficiency();
                
                this.results.currentHeatingCost = (this.results.currentHeatingLoad / heatingEfficiency.efficiency) * 
                    heatingEfficiency.costPerUnit * this.inputs.heatingCost;
                this.results.targetHeatingCost = (this.results.targetHeatingLoad / heatingEfficiency.efficiency) * 
                    heatingEfficiency.costPerUnit * this.inputs.heatingCost;
                    
                this.results.currentCoolingCost = (this.results.currentCoolingLoad / coolingEfficiency) * this.inputs.electricityRate;
                this.results.targetCoolingCost = (this.results.targetCoolingLoad / coolingEfficiency) * this.inputs.electricityRate;
                
                this.results.currentAnnualCost = this.results.currentHeatingCost + this.results.currentCoolingCost;
                this.results.targetAnnualCost = this.results.targetHeatingCost + this.results.targetCoolingCost;
                this.results.annualSavings = this.results.currentAnnualCost - this.results.targetAnnualCost;
            }

            getHeatingEfficiency() {
                const efficiencies = {
                    'natural-gas': { efficiency: 100000, costPerUnit: 1 }, // BTU per therm
                    'electricity': { efficiency: 3412, costPerUnit: 1 }, // BTU per kWh
                    'propane': { efficiency: 91000, costPerUnit: 1 }, // BTU per gallon
                    'heating-oil': { efficiency: 138000, costPerUnit: 1 }, // BTU per gallon
                    'heat-pump': { efficiency: 10236, costPerUnit: 1 }, // BTU per kWh (COP 3.0)
                    'wood': { efficiency: 20000000, costPerUnit: 1 }, // BTU per cord
                    'other': { efficiency: 100000, costPerUnit: 1 }
                };
                
                return efficiencies[this.inputs.heatingFuel] || efficiencies['natural-gas'];
            }

            getCoolingEfficiency() {
                const coolingEfficiencies = {
                    'central-ac': 10, // SEER 10
                    'heat-pump': 12, // SEER 12
                    'window-units': 8, // SEER 8
                    'evap-cooling': 15, // Very efficient
                    'none': 0
                };
                
                return coolingEfficiencies[this.inputs.coolingType] || 10;
            }

            calculateCosts() {
                const { buildingArea, materialCostSqFt, laborCostSqFt, installationMethod, upgradeType } = this.inputs;
                
                // Base costs
                this.results.materialsCost = buildingArea * materialCostSqFt;
                
                // Labor cost adjustments
                const laborMultipliers = {
                    'diy': 0,
                    'contractor': 1.0,
                    'specialty': 1.3
                };
                
                const laborMultiplier = laborMultipliers[installationMethod] || 1.0;
                this.results.laborCost = buildingArea * laborCostSqFt * laborMultiplier;
                
                // Upgrade type cost adjustments
                const upgradeMultipliers = {
                    'add-blown': 0.7,
                    'replace-batts': 1.0,
                    'spray-foam-upgrade': 1.5,
                    'rigid-foam-exterior': 1.8,
                    'complete-retrofit': 2.2
                };
                
                const upgradeMultiplier = upgradeMultipliers[upgradeType] || 1.0;
                
                // Additional costs
                this.results.prepCost = (upgradeType === 'complete-retrofit') ? buildingArea * 0.50 : 
                    (upgradeType === 'replace-batts') ? buildingArea * 0.25 : 0;
                    
                this.results.equipmentCost = (installationMethod === 'diy') ? 150 : 0;
                this.results.permitCost = (upgradeType === 'complete-retrofit') ? 200 : 50;
                
                // Apply upgrade multiplier
                this.results.materialsCost *= upgradeMultiplier;
                this.results.laborCost *= upgradeMultiplier;
                
                this.results.subtotalCost = this.results.materialsCost + this.results.laborCost + 
                    this.results.prepCost + this.results.equipmentCost + this.results.permitCost;
                    
                this.results.totalProjectCost = this.results.subtotalCost;
                this.results.netProjectCost = this.results.totalProjectCost - this.inputs.taxCredits;
            }

            calculateSavings() {
                if (this.results.annualSavings <= 0) {
                    this.results.paybackYears = Infinity;
                    return;
                }
                
                // Simple payback
                this.results.paybackYears = this.results.netProjectCost / this.results.annualSavings;
                
                // Energy reduction percentage
                this.results.energyReductionPercent = ((this.results.currentAnnualCost - this.results.targetAnnualCost) / 
                    this.results.currentAnnualCost) * 100;
            }

            calculateROI() {
                // 20-year financial analysis with energy cost escalation
                const escalationRate = this.inputs.energyEscalation / 100;
                let totalSavings = 0;
                let annualSavings = this.results.annualSavings;
                
                this.results.projectionData = [];
                
                for (let year = 1; year <= 20; year++) {
                    totalSavings += annualSavings;
                    this.results.projectionData.push({
                        year: year,
                        annualSavings: annualSavings,
                        cumulativeSavings: totalSavings
                    });
                    annualSavings *= (1 + escalationRate);
                }
                
                this.results.twentyYearSavings = totalSavings;
                this.results.twentyYearROI = ((totalSavings - this.results.netProjectCost) / this.results.netProjectCost) * 100;
                
                // Net Present Value calculation (6% discount rate)
                const discountRate = 0.06;
                let npv = -this.results.netProjectCost;
                annualSavings = this.results.annualSavings;
                
                for (let year = 1; year <= 20; year++) {
                    npv += annualSavings / Math.pow(1 + discountRate, year);
                    annualSavings *= (1 + escalationRate);
                }
                
                this.results.netPresentValue = npv;
            }

            displayResults() {
                // Energy Savings Analysis
                document.getElementById('currentAnnualCost').textContent = `$${this.results.currentAnnualCost.toFixed(0)}`;
                document.getElementById('projectedAnnualCost').textContent = `$${this.results.targetAnnualCost.toFixed(0)}`;
                document.getElementById('annualSavings').textContent = `$${this.results.annualSavings.toFixed(0)}`;
                document.getElementById('energyReduction').textContent = `${this.results.energyReductionPercent.toFixed(1)}%`;
                
                // Investment Analysis
                document.getElementById('totalProjectCost').textContent = `$${this.results.totalProjectCost.toFixed(0)}`;
                document.getElementById('netProjectCost').textContent = `$${this.results.netProjectCost.toFixed(0)}`;
                
                const paybackText = this.results.paybackYears === Infinity ? 'Never' : 
                    this.results.paybackYears < 1 ? `${(this.results.paybackYears * 12).toFixed(1)} months` :
                    `${this.results.paybackYears.toFixed(1)} years`;
                document.getElementById('paybackPeriod').textContent = paybackText;
                
                document.getElementById('twentyYearROI').textContent = `${this.results.twentyYearROI.toFixed(0)}%`;
                
                // Cost Breakdown
                document.getElementById('materialsCost').textContent = `$${this.results.materialsCost.toFixed(0)}`;
                document.getElementById('laborCost').textContent = `$${this.results.laborCost.toFixed(0)}`;
                document.getElementById('prepCost').textContent = `$${this.results.prepCost.toFixed(0)}`;
                document.getElementById('equipmentCost').textContent = `$${this.results.equipmentCost.toFixed(0)}`;
                document.getElementById('permitCost').textContent = `$${this.results.permitCost.toFixed(0)}`;
                document.getElementById('subtotalCost').textContent = `$${this.results.subtotalCost.toFixed(0)}`;
                document.getElementById('incentivesSavings').textContent = `-$${this.inputs.taxCredits.toFixed(0)}`;
                document.getElementById('finalCost').textContent = `$${this.results.netProjectCost.toFixed(0)}`;
                
                // R-Value Recommendations
                this.displayRValueRecommendations();
                
                // Financial Projection
                this.displayFinancialProjection();
            }

            displayRValueRecommendations() {
                const recDiv = document.getElementById('rValueRecommendations');
                const climateZone = this.inputs.climateZone;
                
                const recommendations = {
                    1: { attic: 'R-30 to R-49', wall: 'R-13 to R-15', floor: 'R-13' },
                    2: { attic: 'R-30 to R-60', wall: 'R-13 to R-15', floor: 'R-13 to R-19' },
                    3: { attic: 'R-30 to R-60', wall: 'R-13 to R-15', floor: 'R-19 to R-25' },
                    4: { attic: 'R-38 to R-60', wall: 'R-13 to R-15', floor: 'R-19 to R-25' },
                    5: { attic: 'R-49 to R-60', wall: 'R-13 to R-20', floor: 'R-25 to R-30' },
                    6: { attic: 'R-49 to R-60', wall: 'R-20 to R-21', floor: 'R-25 to R-30' },
                    7: { attic: 'R-49 to R-60', wall: 'R-20 to R-21', floor: 'R-25 to R-30' },
                    8: { attic: 'R-60+', wall: 'R-21+', floor: 'R-30+' }
                };
                
                const rec = recommendations[climateZone] || recommendations[4];
                
                recDiv.innerHTML = `
                    <div class="recommendation-item">
                        <strong>Climate Zone ${climateZone} Recommendations:</strong>
                    </div>
                    <div class="recommendation-item">
                        <span>Attic/Ceiling:</span>
                        <span class="${this.inputs.targetRValue >= parseInt(rec.attic.split('-')[1] || rec.attic.split('R-')[1]) ? 'meets-code' : 'below-code'}">${rec.attic}</span>
                    </div>
                    <div class="recommendation-item">
                        <span>Walls:</span>
                        <span>${rec.wall}</span>
                    </div>
                    <div class="recommendation-item">
                        <span>Floors:</span>
                        <span>${rec.floor}</span>
                    </div>
                    <div class="recommendation-item">
                        <strong>Your Target R-Value: R-${this.inputs.targetRValue}</strong>
                        <span class="${this.inputs.targetRValue >= 38 ? 'meets-code' : 'below-code'}">
                            ${this.inputs.targetRValue >= 38 ? '✓ Meets/Exceeds' : '⚠ Consider Higher'}
                        </span>
                    </div>
                `;
            }

            displayFinancialProjection() {
                const projDiv = document.getElementById('financialProjection');
                
                if (!this.results.projectionData || this.results.projectionData.length === 0) {
                    projDiv.innerHTML = '<p>Calculating projection...</p>';
                    return;
                }
                
                let html = `
                    <div class="projection-summary">
                        <div class="projection-item">
                            <strong>Year 5:</strong> $${this.results.projectionData[4].cumulativeSavings.toFixed(0)} saved
                        </div>
                        <div class="projection-item">
                            <strong>Year 10:</strong> $${this.results.projectionData[9].cumulativeSavings.toFixed(0)} saved
                        </div>
                        <div class="projection-item">
                            <strong>Year 20:</strong> $${this.results.projectionData[19].cumulativeSavings.toFixed(0)} saved
                        </div>
                    </div>
                    <div class="projection-details">
                        <p><strong>Net Present Value:</strong> $${this.results.netPresentValue.toFixed(0)}</p>
                        <p><strong>Break-even:</strong> ${this.results.paybackYears < 20 ? `Year ${Math.ceil(this.results.paybackYears)}` : 'After 20 years'}</p>
                    </div>
                `;
                
                projDiv.innerHTML = html;
            }

            printResults() {
                const printWindow = window.open('', '_blank');
                const printContent = `
                    <html>
                    <head>
                        <title>Insulation ROI Analysis Results</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .header { text-align: center; margin-bottom: 30px; }
                            .section { margin-bottom: 20px; }
                            .section h3 { color: #2c5282; border-bottom: 2px solid #2c5282; padding-bottom: 5px; }
                            .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
                            .cost-table { width: 100%; border-collapse: collapse; }
                            .cost-table th, .cost-table td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
                            .highlight { background: #e6fffa; padding: 10px; border-radius: 5px; }
                            .total-row { font-weight: bold; border-top: 2px solid #2c5282; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h2>Insulation ROI Analysis Results</h2>
                            <p>Building: ${this.inputs.buildingArea.toLocaleString()} sq ft ${this.inputs.buildingType.replace('-', ' ')}</p>
                            <p>Upgrade: R-${this.inputs.currentRValue} to R-${this.inputs.targetRValue}</p>
                            <p>Generated: ${new Date().toLocaleDateString()}</p>
                        </div>
                        
                        <div class="section">
                            <h3>Investment Summary</h3>
                            <div class="highlight">
                                <div><strong>Net Project Cost:</strong> $${this.results.netProjectCost.toFixed(0)}</div>
                                <div><strong>Annual Energy Savings:</strong> $${this.results.annualSavings.toFixed(0)}</div>
                                <div><strong>Simple Payback Period:</strong> ${this.results.paybackYears === Infinity ? 'Never' : this.results.paybackYears.toFixed(1) + ' years'}</div>
                                <div><strong>20-Year ROI:</strong> ${this.results.twentyYearROI.toFixed(0)}%</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Energy Analysis</h3>
                            <div class="grid">
                                <div>Current Annual Cost: $${this.results.currentAnnualCost.toFixed(0)}</div>
                                <div>Projected Annual Cost: $${this.results.targetAnnualCost.toFixed(0)}</div>
                                <div>Energy Reduction: ${this.results.energyReductionPercent.toFixed(1)}%</div>
                                <div>Climate Zone: ${this.inputs.climateZone}</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Cost Breakdown</h3>
                            <table class="cost-table">
                                <tr><th>Item</th><th>Cost</th></tr>
                                <tr><td>Materials</td><td>$${this.results.materialsCost.toFixed(0)}</td></tr>
                                <tr><td>Labor</td><td>$${this.results.laborCost.toFixed(0)}</td></tr>
                                <tr><td>Preparation</td><td>$${this.results.prepCost.toFixed(0)}</td></tr>
                                <tr><td>Equipment</td><td>$${this.results.equipmentCost.toFixed(0)}</td></tr>
                                <tr><td>Permits</td><td>$${this.results.permitCost.toFixed(0)}</td></tr>
                                <tr><td>Tax Credits/Rebates</td><td>-$${this.inputs.taxCredits.toFixed(0)}</td></tr>
                                <tr class="total-row"><td>Net Project Cost</td><td>$${this.results.netProjectCost.toFixed(0)}</td></tr>
                            </table>
                        </div>
                        
                        <div class="section">
                            <h3>20-Year Financial Projection</h3>
                            <div class="grid">
                                <div>Year 5 Cumulative Savings: $${this.results.projectionData[4].cumulativeSavings.toFixed(0)}</div>
                                <div>Year 10 Cumulative Savings: $${this.results.projectionData[9].cumulativeSavings.toFixed(0)}</div>
                                <div>Year 15 Cumulative Savings: $${this.results.projectionData[14].cumulativeSavings.toFixed(0)}</div>
                                <div>Year 20 Cumulative Savings: $${this.results.projectionData[19].cumulativeSavings.toFixed(0)}</div>
                            </div>
                            <p><strong>Net Present Value:</strong> $${this.results.netPresentValue.toFixed(0)}</p>
                        </div>
                    <script defer>
    document.getElementById('btn-print')?.addEventListener('click', () => window.print());
</script>
</body>
                    </html>
                `;
                
                printWindow.document.write(printContent);
                printWindow.document.close();
                printWindow.print();
            }
        }

        // Initialize calculator
        const calculator = new InsulationROICalculator();
    </script>
<script defer>
    document.getElementById('btn-print')?.addEventListener('click', () => window.print());
</script>
</body>
</html>