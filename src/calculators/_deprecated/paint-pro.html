<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://cdnjs.cloudflare.com; font-src 'self' https://fonts.gstatic.com; img-src 'self' data:;">
    <title>Paint Pro Calculator - Coverage & Costs | CostFlowAI</title>
    <meta name="description" content="Calculate paint coverage, estimate costs, and plan painting projects. Professional paint quantity and labor cost calculator.">
    <link rel="canonical" href="https://costflowai.com/calculators/paint">
    <link rel="stylesheet" href="../assets/css/calculator.css">
    <link rel="stylesheet" href="../assets/css/main.css">
    <!-- Preload critical fonts for better performance -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet"></noscript>
    
    <!-- Preload Font Awesome icons -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet"></noscript>
    
    <!-- Schema Markup for Calculator -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebApplication",
      "name": "Paint Pro Calculator",
      "description": "Calculate paint coverage, estimate costs, and plan painting projects. Professional paint quantity and labor cost calculator.",
      "applicationCategory": "UtilityApplication",
      "url": "https://costflowai.com/calculators/paint",
      "operatingSystem": "Web Browser",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "featureList": [
        "Paint coverage calculations",
        "Cost estimation with material and labor",
        "Surface preparation analysis",
        "Multi-coat paint system support",
        "Professional project planning",
        "Export to PDF/CSV formats"
      ]
    }
    </script>
</head>
<body>
    <header>
        <nav class="nav" role="navigation" aria-label="Main navigation">
            <a href="/">Home</a>
            <a href="/calculators/">Calculators</a>
            <a href="/blog/">Blog</a>
            <a href="/#contact">Contact</a>
            <a href="/#contact">ðŸ’¬ Feedback</a>
        </nav>
        
        <div class="header">
            <h1>ðŸŽ¨ Paint Pro Calculator</h1>
            <p>Professional paint coverage calculator with texture analysis, VOC considerations, and labor estimation</p>
        </div>
    </header>

    <main class="main">
        <div class="container">
            <div class="calc-container" id="paint-calc" data-calc="paint">

                <div class="calc-content">
                    <div class="input-section">
                        <div class="card">
                            <h3><i class="fas fa-home"></i> Project Details</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="projectType">Project Type</label>
                                    <select id="projectType">
                                        <option value="interior-residential" selected>Interior Residential</option>
                                        <option value="exterior-residential">Exterior Residential</option>
                                        <option value="interior-commercial">Interior Commercial</option>
                                        <option value="exterior-commercial">Exterior Commercial</option>
                                        <option value="industrial">Industrial</option>
                                        <option value="specialty">Specialty/Decorative</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="totalArea">Total Surface Area (sq ft)</label>
                                    <input type="number" id="totalArea" data-field="totalArea" value="1200" min="50" step="10">
                                </div>
                                <div class="form-group">
                                    <label for="ceilingArea">Ceiling Area (sq ft)</label>
                                    <input type="number" id="ceilingArea" data-field="ceilingArea" value="400" min="0" step="10">
                                </div>
                                <div class="form-group">
                                    <label for="trimArea">Trim/Millwork (linear ft)</label>
                                    <input type="number" id="trimArea" data-field="trimArea" value="200" min="0" step="5">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-texture"></i> Surface Conditions</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="wallTexture">Wall Texture</label>
                                    <select id="wallTexture">
                                        <option value="smooth" selected>Smooth (Drywall/Plaster)</option>
                                        <option value="light-texture">Light Texture (Orange Peel)</option>
                                        <option value="medium-texture">Medium Texture (Knockdown)</option>
                                        <option value="heavy-texture">Heavy Texture (Popcorn/Stucco)</option>
                                        <option value="masonry">Masonry (Brick/Block)</option>
                                        <option value="wood-siding">Wood Siding</option>
                                        <option value="metal-siding">Metal Siding</option>
                                        <option value="vinyl-siding">Vinyl Siding</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="surfaceCondition">Surface Condition</label>
                                    <select id="surfaceCondition">
                                        <option value="new">New Construction</option>
                                        <option value="good" selected>Good Condition</option>
                                        <option value="fair">Fair (Minor Repairs Needed)</option>
                                        <option value="poor">Poor (Extensive Prep Required)</option>
                                        <option value="damaged">Damaged (Major Repairs)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="previousCoats">Previous Paint Coats</label>
                                    <select id="previousCoats">
                                        <option value="0" selected>Bare Surface/Primer Only</option>
                                        <option value="1-2">1-2 Previous Coats</option>
                                        <option value="3-5">3-5 Previous Coats</option>
                                        <option value="6+">6+ Previous Coats</option>
                                        <option value="lead-paint">Lead Paint (Pre-1978)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="colorChange">Color Change</label>
                                    <select id="colorChange">
                                        <option value="none" selected>Same/Similar Color</option>
                                        <option value="light-to-dark">Light to Dark</option>
                                        <option value="dark-to-light">Dark to Light</option>
                                        <option value="radical-change">Radical Color Change</option>
                                        <option value="bright-colors">Bright/Vivid Colors</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-tint"></i> Paint Selection</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="paintType">Paint Type</label>
                                    <select id="paintType">
                                        <option value="latex-flat">Latex Flat</option>
                                        <option value="latex-eggshell" selected>Latex Eggshell</option>
                                        <option value="latex-satin">Latex Satin</option>
                                        <option value="latex-semi-gloss">Latex Semi-Gloss</option>
                                        <option value="latex-gloss">Latex High-Gloss</option>
                                        <option value="acrylic-flat">Acrylic Flat</option>
                                        <option value="acrylic-satin">Acrylic Satin</option>
                                        <option value="alkyd-semi-gloss">Alkyd Semi-Gloss</option>
                                        <option value="alkyd-gloss">Alkyd High-Gloss</option>
                                        <option value="epoxy">Epoxy Paint</option>
                                        <option value="primer-sealer">Primer/Sealer</option>
                                        <option value="specialty">Specialty Coating</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="paintQuality">Paint Quality</label>
                                    <select id="paintQuality">
                                        <option value="builder-grade">Builder Grade</option>
                                        <option value="good" selected>Good Quality</option>
                                        <option value="premium">Premium</option>
                                        <option value="super-premium">Super Premium</option>
                                        <option value="specialty">Specialty/Custom</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="paintCost">Paint Cost ($/gallon)</label>
                                    <input type="number" id="paintCost" data-field="paintCost" value="55" min="15" max="200" step="1">
                                </div>
                                <div class="form-group">
                                    <label for="vocCompliance">VOC Requirements</label>
                                    <select id="vocCompliance">
                                        <option value="standard" selected>Standard VOC</option>
                                        <option value="low-voc">Low VOC (<100 g/L)</option>
                                        <option value="zero-voc">Zero VOC (<5 g/L)</option>
                                        <option value="green-seal">Green Seal Certified</option>
                                        <option value="leed">LEED Compliant</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-tools"></i> Application Method</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="applicationMethod">Primary Application</label>
                                    <select id="applicationMethod">
                                        <option value="brush-roll" selected>Brush & Roll</option>
                                        <option value="spray-finish">Spray & Back-roll</option>
                                        <option value="spray-only">Spray Only</option>
                                        <option value="brush-only">Brush Only</option>
                                        <option value="specialty">Specialty Application</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="coatsRequired">Coats Required</label>
                                    <select id="coatsRequired">
                                        <option value="1">1 Coat</option>
                                        <option value="2" selected>2 Coats</option>
                                        <option value="3">3 Coats</option>
                                        <option value="primer-1">Primer + 1 Coat</option>
                                        <option value="primer-2">Primer + 2 Coats</option>
                                        <option value="custom">Custom System</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="sprayLoss">Spray Loss Factor (%)</label>
                                    <input type="number" id="sprayLoss" value="15" min="0" max="50" step="5">
                                </div>
                                <div class="form-group">
                                    <label for="environmentalFactors">Environmental Conditions</label>
                                    <select id="environmentalFactors">
                                        <option value="ideal" selected>Ideal (70Â°F, Low Humidity)</option>
                                        <option value="good">Good Conditions</option>
                                        <option value="challenging">Challenging (Hot/Humid/Cold)</option>
                                        <option value="difficult">Difficult (Extreme Conditions)</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-user-hard-hat"></i> Labor & Project</h3>
                            <div class="input-grid">
                                <div class="form-group">
                                    <label for="laborRate">Painter Rate ($/hour)</label>
                                    <input type="number" id="laborRate" data-field="laborRate" value="45" min="20" max="100" step="5">
                                </div>
                                <div class="form-group">
                                    <label for="prepExtent">Prep Work Extent</label>
                                    <select id="prepExtent">
                                        <option value="minimal">Minimal (Clean & Prime)</option>
                                        <option value="standard" selected>Standard (Fill/Sand/Clean)</option>
                                        <option value="extensive">Extensive (Major Repairs)</option>
                                        <option value="restoration">Restoration Level</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="accessDifficulty">Access Difficulty</label>
                                    <select id="accessDifficulty">
                                        <option value="easy" selected>Easy (Ground Level)</option>
                                        <option value="moderate">Moderate (Ladder Work)</option>
                                        <option value="difficult">Difficult (Scaffolding)</option>
                                        <option value="very-difficult">Very Difficult (Lift/Complex)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="overheadMarkup">Overhead & Profit (%)</label>
                                    <input type="number" id="overheadMarkup" value="35" min="15" max="75" step="5">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Calculate Button -->
                        <div class="calculate-button-section">
                            <button type="button" onclick="calculator.calculate()" class="calculate-btn paint" data-action="calculate" aria-label="Calculate paint coverage and cost estimate">
                                <i class="fas fa-paint-roller" aria-hidden="true"></i>
                                Calculate Paint Estimate
                            </button>
                        </div>
                    </div>

                    <div class="results-section" role="status" aria-live="polite">
                        <div class="card">
                            <h3><i class="fas fa-calculator"></i> Coverage Analysis</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Theoretical Coverage:</span>
                                    <span class="value" id="theoreticalCoverage" data-out="theoreticalCoverage">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Actual Coverage (w/ texture):</span>
                                    <span class="value" id="actualCoverage" data-out="actualCoverage">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Total Gallons Needed:</span>
                                    <span class="value highlight" id="totalGallons" data-out="totalGallons">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Coverage Efficiency:</span>
                                    <span class="value" id="coverageEfficiency">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-clock"></i> Labor Analysis</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">Prep Time:</span>
                                    <span class="value" id="prepTime">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Application Time:</span>
                                    <span class="value" id="applicationTime">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Total Labor Hours:</span>
                                    <span class="value" id="totalLaborHours" data-out="totalLaborHours">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Project Duration:</span>
                                    <span class="value" id="projectDuration">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-shopping-cart"></i> Material Requirements</h3>
                            <div id="materialBreakdown" class="material-list">
                                <!-- Material breakdown will be populated here -->
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-leaf"></i> Environmental Impact</h3>
                            <div class="results-grid">
                                <div class="result-item">
                                    <span class="label">VOC Emissions:</span>
                                    <span class="value" id="vocEmissions">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Air Quality Impact:</span>
                                    <span class="value" id="airQualityImpact">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Drying/Cure Time:</span>
                                    <span class="value" id="dryingTime">-</span>
                                </div>
                                <div class="result-item">
                                    <span class="label">Ventilation Required:</span>
                                    <span class="value" id="ventilationRequired">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h3><i class="fas fa-dollar-sign"></i> Cost Summary</h3>
                            <div class="cost-breakdown">
                                <div class="cost-row">
                                    <span>Paint Materials:</span>
                                    <span id="paintMaterialsCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Primer/Supplies:</span>
                                    <span id="suppliesCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Equipment/Tools:</span>
                                    <span id="equipmentCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Material Subtotal:</span>
                                    <span id="materialSubtotal">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Prep Labor:</span>
                                    <span id="prepLaborCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Application Labor:</span>
                                    <span id="applicationLaborCost">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Labor Subtotal:</span>
                                    <span id="laborSubtotal">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Overhead & Profit (<span id="markupPercent">35</span>%):</span>
                                    <span id="overheadCost">$0</span>
                                </div>
                                <div class="cost-row total">
                                    <span>Total Project Cost:</span>
                                    <span id="totalProjectCost" data-out="total">$0</span>
                                </div>
                                <div class="cost-row">
                                    <span>Cost per Square Foot:</span>
                                    <span id="costPerSqFt">$0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="calc-actions">
                    <button data-action="save" aria-label="Save calculation to browser storage"><i class="fas fa-save" aria-hidden="true"></i> Save</button>
                    <button data-action="export" aria-label="Export calculation as CSV file"><i class="fas fa-download" aria-hidden="true"></i> Export CSV</button>
                    <button data-action="share" aria-label="Generate shareable link for calculation"><i class="fas fa-share" aria-hidden="true"></i> Share Link</button>
                    <button data-action="print" aria-label="Print calculation results"><i class="fas fa-print" aria-hidden="true"></i> Print</button>
                    <button data-action="email" aria-label="Email calculation results"><i class="fas fa-envelope" aria-hidden="true"></i> Email</button>
                </div>

                <div class="email-section" id="email-section" style="display: none; margin-top: 1rem;">
                    <div style="display: flex; gap: 0.5rem; align-items: center;">
                        <input type="email" id="email-input" placeholder="Enter email address" aria-label="Email address" style="flex: 1; padding: 0.5rem;">
                        <input type="text" style="position: absolute; left: -9999px;" tabindex="-1" aria-hidden="true"> <!-- honeypot -->
                        <button id="send-email-btn" style="padding: 0.5rem 1rem;">Send Results</button>
                    </div>
                    <div id="email-status" style="margin-top: 0.5rem;"></div>
                </div>

                <div class="methodology-section">
                    <div class="card">
                        <h3><i class="fas fa-info-circle"></i> Calculation Methodology</h3>
                        <div class="methodology-content">
                            <h4>Coverage Calculations:</h4>
                            <p>â€¢ Base coverage rates from paint manufacturer specifications</p>
                            <p>â€¢ Surface texture multipliers based on industry testing data</p>
                            <p>â€¢ Application method efficiency factors for spray vs brush/roll</p>
                            
                            <h4>Labor Productivity:</h4>
                            <p>â€¢ Prep time based on surface condition and repair requirements</p>
                            <p>â€¢ Application rates from painter productivity studies (RSMeans)</p>
                            <p>â€¢ Access difficulty and environmental condition adjustments</p>
                            
                            <h4>VOC & Environmental:</h4>
                            <p>â€¢ VOC content from paint specifications and regulatory data</p>
                            <p>â€¢ Emission calculations per EPA and CARB standards</p>
                            <p>â€¢ Drying times adjusted for temperature and humidity</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; <span id="year"></span> CostFlow AI. Professional construction cost analysis.</p>
        </div>
    </footer>

    <script>
        class PaintProCalculator extends ProCalculator {
            constructor() {
                super('Paint Pro Calculator');
                this.initializeCalculator();
            }

            initializeCalculator() {
                const inputs = [
                    'projectType', 'totalArea', 'ceilingArea', 'trimArea',
                    'wallTexture', 'surfaceCondition', 'previousCoats', 'colorChange',
                    'paintType', 'paintQuality', 'paintCost', 'vocCompliance',
                    'applicationMethod', 'coatsRequired', 'sprayLoss', 'environmentalFactors',
                    'laborRate', 'prepExtent', 'accessDifficulty', 'overheadMarkup'
                ];

                // Input validation and updates only (no automatic calculation)
                inputs.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        // Only add listeners for UI updates, not calculations
                        if (element.type === 'range') {
                            element.addEventListener('input', () => this.updateInputDisplay());
                        }
                    }
                });

                // Update paint cost when quality changes (no auto-calculation)
                document.getElementById('paintQuality').addEventListener('change', () => {
                    this.updatePaintCost();
                });

                this.loadFromURL();
                // Don't auto-calculate on load - user must click Calculate button
            }

            updatePaintCost() {
                const quality = document.getElementById('paintQuality').value;
                const paintCosts = {
                    'builder-grade': 35,
                    'good': 55,
                    'premium': 75,
                    'super-premium': 95,
                    'specialty': 120
                };
                
                document.getElementById('paintCost').value = paintCosts[quality] || 55;
            }

            updateInputDisplay() {
                // Update any range input displays or dependent UI elements
                // This method handles UI updates without triggering calculations
            }

            calculate() {
                this.collectInputs();
                this.calculateCoverage();
                this.calculateLabor();
                this.calculateMaterials();
                this.calculateEnvironmentalImpact();
                this.calculateCosts();
                this.displayResults();
                this.updateInputs();
                
                // Move focus to results for accessibility
                const resultsSection = document.querySelector('.results-section');
                if (resultsSection) {
                    resultsSection.setAttribute('tabindex', '-1');
                    resultsSection.focus();
                    setTimeout(() => resultsSection.removeAttribute('tabindex'), 100);
                }
                
                // Set lastCalculation for export compatibility
                if (this.results) {
                    window.lastCalculation = {
                        type: 'paint',
                        title: 'Paint Pro Calculator Results',
                        inputs: this.inputs || {},
                        results: this.results,
                        timestamp: new Date().toISOString()
                    };
                    
                    // Back-compat aliases
                    window.lastCalculationByType = window.lastCalculationByType || {};
                    window.lastCalculationByType.paint = window.lastCalculation;
                    window.lastCalculation.paint = window.lastCalculation; // legacy alias for older code
                }
            }

            collectInputs() {
                this.inputs = {
                    projectType: document.getElementById('projectType').value || 'interior-residential',
                    totalArea: parseFloat(document.getElementById('totalArea').value) || 1200,
                    ceilingArea: parseFloat(document.getElementById('ceilingArea').value) || 400,
                    trimArea: parseFloat(document.getElementById('trimArea').value) || 200,
                    wallTexture: document.getElementById('wallTexture').value || 'smooth',
                    surfaceCondition: document.getElementById('surfaceCondition').value || 'good',
                    previousCoats: document.getElementById('previousCoats').value || '0',
                    colorChange: document.getElementById('colorChange').value || 'none',
                    paintType: document.getElementById('paintType').value || 'latex-eggshell',
                    paintQuality: document.getElementById('paintQuality').value || 'good',
                    paintCost: parseFloat(document.getElementById('paintCost').value) || 55,
                    vocCompliance: document.getElementById('vocCompliance').value || 'standard',
                    applicationMethod: document.getElementById('applicationMethod').value || 'brush-roll',
                    coatsRequired: document.getElementById('coatsRequired').value || '2',
                    sprayLoss: parseFloat(document.getElementById('sprayLoss').value) || 15,
                    environmentalFactors: document.getElementById('environmentalFactors').value || 'ideal',
                    laborRate: parseFloat(document.getElementById('laborRate').value) || 45,
                    prepExtent: document.getElementById('prepExtent').value || 'standard',
                    accessDifficulty: document.getElementById('accessDifficulty').value || 'easy',
                    overheadMarkup: parseFloat(document.getElementById('overheadMarkup').value) || 35
                };
            }

            calculateCoverage() {
                // Base coverage rates (sq ft per gallon)
                const baseCoverageRates = {
                    'latex-flat': 400,
                    'latex-eggshell': 375,
                    'latex-satin': 350,
                    'latex-semi-gloss': 325,
                    'latex-gloss': 300,
                    'acrylic-flat': 380,
                    'acrylic-satin': 340,
                    'alkyd-semi-gloss': 300,
                    'alkyd-gloss': 275,
                    'epoxy': 250,
                    'primer-sealer': 350,
                    'specialty': 200
                };

                const baseCoverage = baseCoverageRates[this.inputs.paintType] || 350;
                this.results.theoreticalCoverage = baseCoverage;

                // Texture multipliers
                const textureMultipliers = {
                    'smooth': 1.0,
                    'light-texture': 0.85,
                    'medium-texture': 0.75,
                    'heavy-texture': 0.60,
                    'masonry': 0.50,
                    'wood-siding': 0.80,
                    'metal-siding': 0.90,
                    'vinyl-siding': 0.95
                };

                const textureMultiplier = textureMultipliers[this.inputs.wallTexture] || 1.0;

                // Surface condition multipliers
                const conditionMultipliers = {
                    'new': 1.0,
                    'good': 0.95,
                    'fair': 0.85,
                    'poor': 0.75,
                    'damaged': 0.60
                };

                const conditionMultiplier = conditionMultipliers[this.inputs.surfaceCondition] || 0.95;

                // Color change multipliers
                const colorChangeMultipliers = {
                    'none': 1.0,
                    'light-to-dark': 0.95,
                    'dark-to-light': 0.75,
                    'radical-change': 0.70,
                    'bright-colors': 0.80
                };

                const colorChangeMultiplier = colorChangeMultipliers[this.inputs.colorChange] || 1.0;

                // Calculate actual coverage
                this.results.actualCoverage = baseCoverage * textureMultiplier * conditionMultiplier * colorChangeMultiplier;

                // Calculate coats needed
                const coatsMultiplier = this.getCoatsMultiplier();

                // Application method efficiency
                const applicationEfficiency = this.getApplicationEfficiency();

                // Calculate total area to paint
                this.results.totalPaintableArea = this.inputs.totalArea + this.inputs.ceilingArea + (this.inputs.trimArea * 0.5); // Trim width factor

                // Calculate gallons needed
                const baseGallonsNeeded = (this.results.totalPaintableArea * coatsMultiplier) / this.results.actualCoverage;
                
                // Apply spray loss and inefficiency
                this.results.totalGallons = baseGallonsNeeded / applicationEfficiency;
                
                // Add 10% contingency
                this.results.totalGallons *= 1.10;

                // Calculate efficiency rating
                this.results.coverageEfficiency = (this.results.actualCoverage / this.results.theoreticalCoverage * 100);
            }

            getCoatsMultiplier() {
                const coatsMap = {
                    '1': 1.0,
                    '2': 2.0,
                    '3': 3.0,
                    'primer-1': 1.5,
                    'primer-2': 2.5,
                    'custom': 2.2
                };
                
                return coatsMap[this.inputs.coatsRequired] || 2.0;
            }

            getApplicationEfficiency() {
                const methodEfficiency = {
                    'brush-roll': 0.95,
                    'spray-finish': 0.85,
                    'spray-only': 0.75,
                    'brush-only': 0.90,
                    'specialty': 0.80
                };
                
                let efficiency = methodEfficiency[this.inputs.applicationMethod] || 0.95;
                
                // Apply spray loss if applicable
                if (this.inputs.applicationMethod.includes('spray')) {
                    efficiency *= (100 - this.inputs.sprayLoss) / 100;
                }
                
                return efficiency;
            }

            calculateLabor() {
                // Prep time rates (hours per 100 sq ft)
                const prepRates = {
                    'minimal': 0.5,
                    'standard': 1.0,
                    'extensive': 2.5,
                    'restoration': 4.0
                };

                const prepRate = prepRates[this.inputs.prepExtent] || 1.0;
                this.results.prepTime = (this.results.totalPaintableArea / 100) * prepRate;

                // Application rates (sq ft per hour)
                const applicationRates = {
                    'brush-roll': 120,
                    'spray-finish': 200,
                    'spray-only': 300,
                    'brush-only': 80,
                    'specialty': 60
                };

                const baseApplicationRate = applicationRates[this.inputs.applicationMethod] || 120;

                // Access difficulty multipliers
                const accessMultipliers = {
                    'easy': 1.0,
                    'moderate': 0.8,
                    'difficult': 0.6,
                    'very-difficult': 0.4
                };

                const accessMultiplier = accessMultipliers[this.inputs.accessDifficulty] || 1.0;

                // Environmental factor multipliers
                const environmentalMultipliers = {
                    'ideal': 1.0,
                    'good': 0.95,
                    'challenging': 0.80,
                    'difficult': 0.65
                };

                const environmentalMultiplier = environmentalMultipliers[this.inputs.environmentalFactors] || 1.0;

                const adjustedRate = baseApplicationRate * accessMultiplier * environmentalMultiplier;

                // Apply coats multiplier
                const coatsMultiplier = this.getCoatsMultiplier();
                const totalPaintTime = (this.results.totalPaintableArea * coatsMultiplier) / adjustedRate;

                this.results.applicationTime = totalPaintTime;
                this.results.totalLaborHours = this.results.prepTime + this.results.applicationTime;

                // Add cleanup and setup time (15% of total)
                this.results.totalLaborHours *= 1.15;

                // Project duration (8 hour days, including dry time)
                const workingHoursPerDay = 6; // Account for setup/cleanup
                this.results.projectDuration = Math.ceil(this.results.totalLaborHours / workingHoursPerDay);

                // Add drying days between coats
                if (coatsMultiplier > 1) {
                    this.results.projectDuration += Math.floor(coatsMultiplier - 1);
                }
            }

            calculateMaterials() {
                // Paint cost
                this.results.paintCost = this.results.totalGallons * this.inputs.paintCost;

                // Primer cost (if needed)
                const needsPrimer = this.inputs.coatsRequired.includes('primer') || 
                    this.inputs.surfaceCondition === 'new' || 
                    this.inputs.colorChange === 'dark-to-light';

                this.results.primerCost = needsPrimer ? (this.results.totalGallons * 0.3 * this.inputs.paintCost * 0.8) : 0;

                // Supplies cost (brushes, rollers, drop cloths, tape, etc.)
                this.results.suppliesCost = Math.max(150, this.results.totalPaintableArea * 0.15);

                // Equipment rental/depreciation
                const equipmentCosts = {
                    'brush-roll': 50,
                    'spray-finish': 200,
                    'spray-only': 300,
                    'brush-only': 25,
                    'specialty': 400
                };

                this.results.equipmentCost = equipmentCosts[this.inputs.applicationMethod] || 50;

                this.results.totalMaterialCost = this.results.paintCost + this.results.primerCost + 
                    this.results.suppliesCost + this.results.equipmentCost;
            }

            calculateEnvironmentalImpact() {
                // VOC content (grams per liter)
                const vocContent = {
                    'standard': 250,
                    'low-voc': 75,
                    'zero-voc': 3,
                    'green-seal': 50,
                    'leed': 50
                };

                const vocLevel = vocContent[this.inputs.vocCompliance] || 250;
                const gallonsToLiters = 3.78541;
                
                this.results.vocEmissions = (this.results.totalGallons * gallonsToLiters * vocLevel / 1000).toFixed(2); // kg

                // Air quality impact rating
                if (vocLevel < 10) {
                    this.results.airQualityImpact = 'Excellent';
                } else if (vocLevel < 50) {
                    this.results.airQualityImpact = 'Very Good';
                } else if (vocLevel < 100) {
                    this.results.airQualityImpact = 'Good';
                } else if (vocLevel < 200) {
                    this.results.airQualityImpact = 'Fair';
                } else {
                    this.results.airQualityImpact = 'Poor';
                }

                // Drying time based on paint type and environmental conditions
                const baseDryTimes = {
                    'latex-flat': 2,
                    'latex-eggshell': 2,
                    'latex-satin': 3,
                    'latex-semi-gloss': 4,
                    'latex-gloss': 6,
                    'acrylic-flat': 2,
                    'acrylic-satin': 3,
                    'alkyd-semi-gloss': 8,
                    'alkyd-gloss': 12,
                    'epoxy': 24,
                    'primer-sealer': 2,
                    'specialty': 6
                };

                const baseDryTime = baseDryTimes[this.inputs.paintType] || 4;
                
                const envMultipliers = {
                    'ideal': 1.0,
                    'good': 1.2,
                    'challenging': 1.8,
                    'difficult': 2.5
                };

                const dryTimeHours = baseDryTime * (envMultipliers[this.inputs.environmentalFactors] || 1.0);
                this.results.dryingTime = dryTimeHours < 24 ? `${dryTimeHours} hours` : `${Math.ceil(dryTimeHours/24)} days`;

                // Ventilation requirements
                if (vocLevel > 150) {
                    this.results.ventilationRequired = 'Mechanical ventilation required';
                } else if (vocLevel > 75) {
                    this.results.ventilationRequired = 'Adequate cross-ventilation';
                } else {
                    this.results.ventilationRequired = 'Standard ventilation acceptable';
                }
            }

            calculateCosts() {
                // Labor costs
                this.results.prepLaborCost = this.results.prepTime * this.inputs.laborRate;
                this.results.applicationLaborCost = this.results.applicationTime * this.inputs.laborRate;
                this.results.totalLaborCost = this.results.prepLaborCost + this.results.applicationLaborCost;

                // Add setup/cleanup time cost
                this.results.totalLaborCost *= 1.15;

                // Subtotals
                this.results.materialSubtotal = this.results.totalMaterialCost;
                this.results.laborSubtotal = this.results.totalLaborCost;

                // Overhead and profit
                const subtotalCost = this.results.materialSubtotal + this.results.laborSubtotal;
                this.results.overheadCost = subtotalCost * (this.inputs.overheadMarkup / 100);

                // Total project cost
                this.results.totalProjectCost = subtotalCost + this.results.overheadCost;

                // Cost per square foot
                this.results.costPerSqFt = this.results.totalProjectCost / this.results.totalPaintableArea;
            }

            displayResults() {
                // Coverage Analysis
                document.getElementById('theoreticalCoverage').textContent = `${this.results.theoreticalCoverage} sq ft/gal`;
                document.getElementById('actualCoverage').textContent = `${this.results.actualCoverage.toFixed(0)} sq ft/gal`;
                document.getElementById('totalGallons').textContent = `${this.results.totalGallons.toFixed(1)} gallons`;
                document.getElementById('coverageEfficiency').textContent = `${this.results.coverageEfficiency.toFixed(1)}%`;

                // Labor Analysis
                document.getElementById('prepTime').textContent = `${this.results.prepTime.toFixed(1)} hours`;
                document.getElementById('applicationTime').textContent = `${this.results.applicationTime.toFixed(1)} hours`;
                document.getElementById('totalLaborHours').textContent = `${this.results.totalLaborHours.toFixed(1)} hours`;
                document.getElementById('projectDuration').textContent = `${this.results.projectDuration} days`;

                // Material Requirements
                this.displayMaterialBreakdown();

                // Environmental Impact
                document.getElementById('vocEmissions').textContent = `${this.results.vocEmissions} kg`;
                document.getElementById('airQualityImpact').textContent = this.results.airQualityImpact;
                document.getElementById('dryingTime').textContent = this.results.dryingTime;
                document.getElementById('ventilationRequired').textContent = this.results.ventilationRequired;

                // Costs
                document.getElementById('paintMaterialsCost').textContent = `$${(this.results.paintCost + this.results.primerCost).toFixed(2)}`;
                document.getElementById('suppliesCost').textContent = `$${this.results.suppliesCost.toFixed(2)}`;
                document.getElementById('equipmentCost').textContent = `$${this.results.equipmentCost.toFixed(2)}`;
                document.getElementById('materialSubtotal').textContent = `$${this.results.materialSubtotal.toFixed(2)}`;
                document.getElementById('prepLaborCost').textContent = `$${this.results.prepLaborCost.toFixed(2)}`;
                document.getElementById('applicationLaborCost').textContent = `$${this.results.applicationLaborCost.toFixed(2)}`;
                document.getElementById('laborSubtotal').textContent = `$${this.results.laborSubtotal.toFixed(2)}`;
                document.getElementById('markupPercent').textContent = this.inputs.overheadMarkup;
                document.getElementById('overheadCost').textContent = `$${this.results.overheadCost.toFixed(2)}`;
                document.getElementById('totalProjectCost').textContent = `$${this.results.totalProjectCost.toFixed(2)}`;
                document.getElementById('costPerSqFt').textContent = `$${this.results.costPerSqFt.toFixed(2)}`;
            }

            displayMaterialBreakdown() {
                const breakdownDiv = document.getElementById('materialBreakdown');
                
                breakdownDiv.innerHTML = `
                    <div class="material-item">
                        <div class="material-description">
                            <strong>Paint (${this.inputs.paintType.replace('-', ' ')})</strong>
                            <span>${this.results.totalGallons.toFixed(1)} gallons</span>
                        </div>
                        <div class="material-cost">$${this.results.paintCost.toFixed(2)}</div>
                    </div>
                    ${this.results.primerCost > 0 ? `
                    <div class="material-item">
                        <div class="material-description">
                            <strong>Primer/Sealer</strong>
                            <span>${(this.results.totalGallons * 0.3).toFixed(1)} gallons</span>
                        </div>
                        <div class="material-cost">$${this.results.primerCost.toFixed(2)}</div>
                    </div>` : ''}
                    <div class="material-item">
                        <div class="material-description">
                            <strong>Brushes, Rollers & Supplies</strong>
                            <span>Complete set</span>
                        </div>
                        <div class="material-cost">$${this.results.suppliesCost.toFixed(2)}</div>
                    </div>
                    <div class="material-item">
                        <div class="material-description">
                            <strong>Equipment (${this.inputs.applicationMethod.replace('-', ' ')})</strong>
                            <span>Rental/depreciation</span>
                        </div>
                        <div class="material-cost">$${this.results.equipmentCost.toFixed(2)}</div>
                    </div>
                `;
            }

            printResults() {
                const printWindow = window.open('', '_blank');
                const printContent = `
                    <html>
                    <head>
                        <title>Paint Pro Calculator Results</title>
                        <style>
                            body { font-family: Arial, sans-serif; margin: 20px; }
                            .header { text-align: center; margin-bottom: 30px; }
                            .section { margin-bottom: 20px; }
                            .section h3 { color: #2c5282; border-bottom: 2px solid #2c5282; padding-bottom: 5px; }
                            .grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
                            .cost-table { width: 100%; border-collapse: collapse; }
                            .cost-table th, .cost-table td { padding: 8px; text-align: left; border-bottom: 1px solid #ddd; }
                            .highlight { background: #e6fffa; padding: 10px; border-radius: 5px; }
                            .total-row { font-weight: bold; border-top: 2px solid #2c5282; }
                        </style>
                    </head>
                    <body>
                        <div class="header">
                            <h2>Paint Pro Calculator Results</h2>
                            <p>Project: ${this.inputs.projectType.replace('-', ' ')} - ${this.results.totalPaintableArea.toFixed(0)} sq ft</p>
                            <p>Paint: ${this.inputs.paintType.replace('-', ' ')} (${this.inputs.paintQuality})</p>
                            <p>Generated: ${new Date().toLocaleDateString()}</p>
                        </div>
                        
                        <div class="section">
                            <h3>Coverage & Materials</h3>
                            <div class="highlight">
                                <div><strong>Paint Needed:</strong> ${this.results.totalGallons.toFixed(1)} gallons</div>
                                <div><strong>Coverage Rate:</strong> ${this.results.actualCoverage.toFixed(0)} sq ft/gallon</div>
                                <div><strong>Application Method:</strong> ${this.inputs.applicationMethod.replace('-', ' ')}</div>
                                <div><strong>Coats:</strong> ${this.inputs.coatsRequired}</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Labor Analysis</h3>
                            <div class="grid">
                                <div>Prep Time: ${this.results.prepTime.toFixed(1)} hours</div>
                                <div>Application Time: ${this.results.applicationTime.toFixed(1)} hours</div>
                                <div>Total Labor: ${this.results.totalLaborHours.toFixed(1)} hours</div>
                                <div>Project Duration: ${this.results.projectDuration} days</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Environmental Impact</h3>
                            <div class="grid">
                                <div>VOC Emissions: ${this.results.vocEmissions} kg</div>
                                <div>Air Quality Impact: ${this.results.airQualityImpact}</div>
                                <div>Drying Time: ${this.results.dryingTime}</div>
                                <div>Ventilation: ${this.results.ventilationRequired}</div>
                            </div>
                        </div>
                        
                        <div class="section">
                            <h3>Cost Summary</h3>
                            <table class="cost-table">
                                <tr><th>Item</th><th>Cost</th></tr>
                                <tr><td>Materials</td><td>$${this.results.materialSubtotal.toFixed(2)}</td></tr>
                                <tr><td>Labor</td><td>$${this.results.laborSubtotal.toFixed(2)}</td></tr>
                                <tr><td>Overhead & Profit (${this.inputs.overheadMarkup}%)</td><td>$${this.results.overheadCost.toFixed(2)}</td></tr>
                                <tr class="total-row"><td>Total Project Cost</td><td>$${this.results.totalProjectCost.toFixed(2)}</td></tr>
                            </table>
                            <p><strong>Cost per Square Foot:</strong> $${this.results.costPerSqFt.toFixed(2)}</p>
                        </div>
</body>
                    </html>
                `;
                
                printWindow.document.write(printContent);
                printWindow.document.close();
                printWindow.print();
            }

            exportCSV() {
                // Use export utilities if available, otherwise fallback
                if (window.exportUtils && window.exportUtils.exportToCSV) {
                    const exportData = {
                        title: 'Paint Pro Calculator Results',
                        projectInfo: {
                            calculatorType: 'paint',
                            timestamp: new Date().toISOString()
                        },
                        breakdown: [],
                        summary: this.results || {}
                    };
                    
                    if (this.inputs) {
                        Object.entries(this.inputs).forEach(([key, value]) => {
                            exportData.projectInfo[key] = value;
                        });
                    }
                    
                    window.exportUtils.exportToCSV(exportData, 'paint-pro-calculator');
                } else {
                    alert('Export functionality will be available once the page fully loads.');
                }
            }

            saveCalculation() {
                if (this.results && this.inputs) {
                    const saveData = {
                        type: 'paint',
                        title: 'Paint Pro Calculator Results',
                        inputs: this.inputs,
                        results: this.results,
                        timestamp: new Date().toISOString()
                    };
                    
                    const saveKey = `costflowai_paint_pro_${Date.now()}`;
                    localStorage.setItem(saveKey, JSON.stringify(saveData));
                    alert('Calculation saved successfully!');
                } else {
                    alert('Please calculate results first before saving.');
                }
            }

            shareLink() {
                // Generate a shareable URL with parameters
                const url = new URL(window.location.href);
                if (this.inputs) {
                    Object.entries(this.inputs).forEach(([key, value]) => {
                        url.searchParams.set(key, value);
                    });
                }
                
                if (navigator.share) {
                    navigator.share({
                        title: 'Paint Pro Calculator Results',
                        text: `Check out my paint calculation: Total Cost $${this.results?.totalProjectCost?.toFixed(2) || 0}`,
                        url: url.toString()
                    });
                } else {
                    // Fallback to copy
                    navigator.clipboard.writeText(url.toString()).then(() => {
                        alert('Share link copied to clipboard!');
                    });
                }
            }
        }

        // Initialize calculator and wire with unified dispatcher
        const calculator = new PaintProCalculator();
        
        // Back-compat for exports - wire PaintProCalculator to unified system
        window.paintPro = {
            compute: (section) => {
                // Use the existing calculator's compute method
                calculator.calculate();
                
                // Set lastCalculation for export compatibility
                if (calculator.results) {
                    window.lastCalculation = {
                        type: 'paint',
                        title: 'Paint Pro Calculator Results',
                        inputs: calculator.inputs || {},
                        results: calculator.results,
                        timestamp: new Date().toISOString()
                    };
                    
                    // Back-compat aliases
                    window.lastCalculationByType = window.lastCalculationByType || {};
                    window.lastCalculationByType.paint = window.lastCalculation;
                    window.lastCalculation.paint = window.lastCalculation; // legacy alias for older code
                }
            }
        };
    </script>
    
    <script src="/assets/js/calculator-core.js" defer></script>
    <script src="/assets/js/export-utilities.js" defer></script>
    <script src="/assets/js/calculators-hub.js" defer></script>

<!-- Inline scripts moved to defer for better performance -->
<script defer>
    document.addEventListener('DOMContentLoaded', function() {
        // Set dynamic year
        const yearSpan = document.getElementById('year');
        if (yearSpan) {
            yearSpan.textContent = new Date().getFullYear();
        }
        
        // Print button event listener
        document.getElementById('btn-print')?.addEventListener('click', () => window.print());
    });
</script>

<script>
// Lazy load methodology sections
document.addEventListener('DOMContentLoaded', function() {
    const lazyElements = document.querySelectorAll('.methodology-section, .disclaimer-section');
    
    if ('IntersectionObserver' in window) {
        const lazyObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('loaded');
                    lazyObserver.unobserve(entry.target);
                }
            });
        }, { rootMargin: '100px' });
        
        lazyElements.forEach(el => {
            el.style.opacity = '0';
            el.style.transition = 'opacity 0.3s';
            lazyObserver.observe(el);
        });
        
        // Add loaded class handler
        const style = document.createElement('style');
        style.textContent = '.methodology-section.loaded, .disclaimer-section.loaded { opacity: 1 !important; }';
        document.head.appendChild(style);
    }
});
</script>
</body>
</html>