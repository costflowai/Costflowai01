<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
  <title>Excavation Calculator - Cut Fill & Equipment | CostFlowAI</title>
  <meta name="description" content="Calculate excavation costs, analyze cut/fill operations, and size equipment. Professional earthwork estimation for construction projects.">
  <link rel="canonical" href="https://costflowai.com/calculators/excavation.html">
      <link rel="preload" href="/assets/css/calculator.css" as="style">
    <link rel="preload" href="/assets/js/calculator-core.js" as="script">
    <link rel="dns-prefetch" href="//cdn.jsdelivr.net">
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/print.css" media="print">
  <!-- Preconnect for performance -->
  <link rel="preconnect" href="https://www.googletagmanager.com">
  <link rel="preconnect" href="https://www.google-analytics.com">
  <style>
    .calc-container { max-width: 1200px; margin: 0 auto; padding: 2rem; }
    .calc-header { text-align: center; margin-bottom: 2rem; }
    .quick-actions { display: flex; gap: 1rem; justify-content: center; margin: 1rem 0; }
    .calc-body { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
    .input-section { background: #f7fafc; padding: 1.5rem; border-radius: 8px; }
    .results-section { background: white; border: 2px solid #e2e8f0; padding: 1.5rem; border-radius: 8px; }
    .input-group { margin-bottom: 1rem; }
    .input-group label { display: block; font-weight: 600; margin-bottom: 0.25rem; }
    .input-group input, .input-group select { width: 100%; padding: 0.5rem; border: 1px solid #e2e8f0; border-radius: 4px; }
    .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 4px; cursor: pointer; margin: 0.25rem; }
    .btn-primary { background: #ff6b35; color: white; }
    .btn-secondary { background: #e2e8f0; }
    .result-primary { font-size: 2rem; font-weight: bold; color: #1e3a5f; }
    .breakdown-table { width: 100%; margin-top: 1rem; }
    .breakdown-table td { padding: 0.5rem; border-bottom: 1px solid #e2e8f0; }
    .disclaimer { background: #fff5f5; border-left: 3px solid #ff6b35; padding: 1rem; margin-top: 2rem; }
    .site-section { background: #f9f9f9; padding: 1rem; border-radius: 8px; margin-bottom: 1rem; }
    .equipment-section { background: #f0f9ff; padding: 1rem; border-radius: 8px; margin-top: 1rem; }
    .soil-analysis { background: #fef7ed; padding: 1rem; border-radius: 8px; margin-top: 1rem; }
    .cut-fill { background: #f6ffed; padding: 1rem; border-radius: 8px; margin-top: 1rem; }
    @media (max-width: 768px) { .calc-body { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
    <a href="#main-content" class="sr-only skip-nav">Skip to main content</a>
<header>
    <nav class="nav" role="navigation" aria-label="Main navigation">
        <a href="/">Home</a>
        <a href="/calculators/">Calculators</a>
        <a href="/blog/">Blog</a>
        <a href="/#contact">Contact</a>
        <a href="/#contact">üí¨ Feedback</a>
    </nav>
    
    <div class="header">
        <h1>‚õèÔ∏è Excavation Calculator</h1>
        <p>Cut/fill analysis, soil classification, and equipment sizing for earthwork projects</p>
    </div>
</header>

<main id="main-content">
  <div class="calc-container" id="excavation-calc" data-calc="excavation">
      <div class="quick-actions">
        <button class="btn btn-secondary" onclick="loadDefaults('foundation')">Foundation Excavation</button>
        <button class="btn btn-secondary" onclick="loadDefaults('grading')">Site Grading</button>
        <button class="btn btn-secondary" onclick="loadLastUsed()">Load Last Used</button>
      </div>
    </div>

    <div class="calc-body">
      <div class="input-section">
        <h3>Site Parameters</h3>
        
        <!-- Project Type -->
        <div class="input-group">
          <label>Project Type</label>
          <select id="projectType">
            <option value="foundation">Foundation Excavation</option>
            <option value="utility">Utility Trenching</option>
            <option value="grading" selected>Site Grading</option>
            <option value="pond">Pond/Retention</option>
            <option value="driveway">Driveway/Parking</option>
            <option value="septic">Septic System</option>
          </select>
        </div>

        <!-- Site Dimensions -->
        <div class="site-section">
          <h4>Excavation Area</h4>
          
          <div class="input-group">
            <label>Length (feet)</label>
            <input type="number" id="length" value="100" min="1" step="0.1">
          </div>
          
          <div class="input-group">
            <label>Width (feet)</label>
            <input type="number" id="width" value="50" min="1" step="0.1">
          </div>

          <div class="input-group">
            <label>Average Cut Depth (feet)</label>
            <input type="number" id="cutDepth" value="3" min="0" step="0.1">
          </div>

          <div class="input-group">
            <label>Fill Area Required (sq ft)</label>
            <input type="number" id="fillArea" value="0" min="0">
          </div>

          <div class="input-group">
            <label>Average Fill Height (feet)</label>
            <input type="number" id="fillHeight" value="0" min="0" step="0.1">
          </div>
        </div>

        <!-- Soil Conditions -->
        <div class="site-section">
          <h4>Soil Characteristics</h4>
          
          <div class="input-group">
            <label>Primary Soil Type</label>
            <select id="soilType">
              <option value="sand">Sand (Easy digging)</option>
              <option value="loam" selected>Loam (Average conditions)</option>
              <option value="clay">Clay (Moderate difficulty)</option>
              <option value="hardpan">Hardpan (Difficult)</option>
              <option value="rock">Rock (Very difficult)</option>
              <option value="mixed">Mixed Conditions</option>
            </select>
          </div>

          <div class="input-group">
            <label>Moisture Content</label>
            <select id="moistureContent">
              <option value="dry">Dry</option>
              <option value="normal" selected>Normal</option>
              <option value="wet">Wet</option>
              <option value="saturated">Saturated</option>
            </select>
          </div>

          <div class="input-group">
            <label>Rock Content (%)</label>
            <input type="number" id="rockContent" value="0" min="0" max="100">
          </div>

          <div class="input-group">
            <label>Slope/Grade Requirements</label>
            <select id="slopeRequirement">
              <option value="level">Level (0%)</option>
              <option value="slight">Slight Grade (1-2%)</option>
              <option value="moderate" selected>Moderate Grade (3-5%)</option>
              <option value="steep">Steep Grade (6-10%)</option>
              <option value="very_steep">Very Steep (>10%)</option>
            </select>
          </div>
        </div>

        <!-- Site Conditions -->
        <div class="site-section">
          <h4>Site Access & Conditions</h4>
          
          <div class="input-group">
            <label>Access Difficulty</label>
            <select id="accessDifficulty">
              <option value="easy">Easy (Open access)</option>
              <option value="moderate" selected>Moderate (Some restrictions)</option>
              <option value="difficult">Difficult (Limited access)</option>
              <option value="very_difficult">Very Difficult (Tight spaces)</option>
            </select>
          </div>

          <div class="input-group">
            <label>Haul Distance (miles)</label>
            <input type="number" id="haulDistance" value="5" min="0" step="0.5">
          </div>

          <div class="input-group">
            <label>Compaction Required</label>
            <select id="compactionRequired">
              <option value="none">No Compaction</option>
              <option value="light">Light Compaction</option>
              <option value="standard" selected>Standard Compaction</option>
              <option value="heavy">Heavy Compaction</option>
            </select>
          </div>

          <div class="input-group">
            <label>Weather Conditions</label>
            <select id="weatherConditions">
              <option value="ideal">Ideal Conditions</option>
              <option value="normal" selected>Normal Weather</option>
              <option value="poor">Poor Weather</option>
              <option value="winter">Winter Conditions</option>
            </select>
          </div>
        </div>

        <button class="btn btn-primary" data-action="calculate" style="width: 100%; margin-top: 1rem;">Calculate Excavation</button>
      </div>

      <div class="results-section">
        <h3>Excavation Results</h3>
        
        <div style="text-align: center; padding: 1rem; background: #f7fafc; border-radius: 8px;">
          <div>Total Excavation Volume</div>
          <div class="result-primary" id="totalVolume">0 cu yd</div>
          <div style="color: #718096;" id="volumeDetails">Cut and fill volumes</div>
        </div>

        <div style="text-align: center; padding: 1rem; margin-top: 1rem; background: #fff5f5; border-radius: 8px;">
          <div>Total Project Cost</div>
          <div class="result-primary" id="totalCost">$0</div>
          <div style="color: #718096;">Including equipment, labor, and haul</div>
        </div>

        <div class="cut-fill">
          <h4>Cut/Fill Analysis</h4>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
            <div>
              <strong>Cut Volume</strong>
              <div id="cutVolume">0 cu yd</div>
              <div style="color: #718096; font-size: 0.9rem;">Material to remove</div>
            </div>
            <div>
              <strong>Fill Volume</strong>
              <div id="fillVolume">0 cu yd</div>
              <div style="color: #718096; font-size: 0.9rem;">Material needed</div>
            </div>
          </div>
          <div style="margin-top: 1rem;">
            <strong>Balance: <span id="soilBalance">0 cu yd</span></strong>
            <div style="color: #718096;" id="balanceNote">Excess (+) or shortage (-)</div>
          </div>
        </div>

        <h4 style="margin-top: 1.5rem;">Cost Breakdown</h4>
        <table class="breakdown-table">
          <tr><td>Excavation Labor</td><td align="right" id="excavationCost">$0</td></tr>
          <tr><td>Equipment Rental</td><td align="right" id="equipmentCost">$0</td></tr>
          <tr><td>Hauling Costs</td><td align="right" id="haulingCost">$0</td></tr>
          <tr><td>Compaction</td><td align="right" id="compactionCost">$0</td></tr>
          <tr><td>Site Restoration</td><td align="right" id="restorationCost">$0</td></tr>
          <tr><td>Material (if needed)</td><td align="right" id="materialCost">$0</td></tr>
          <tr><td>Weather/Access Premium</td><td align="right" id="premiumCost">$0</td></tr>
        </table>

        <div class="equipment-section">
          <h4>Recommended Equipment</h4>
          <div id="equipmentRecommendation">
            <div><strong>Primary:</strong> <span id="primaryEquipment">Excavator</span></div>
            <div><strong>Size:</strong> <span id="equipmentSize">15-20 ton</span></div>
            <div><strong>Productivity:</strong> <span id="productivity">120 cu yd/hour</span></div>
            <div><strong>Estimated Time:</strong> <span id="estimatedTime">8 hours</span></div>
          </div>
          
          <h5 style="margin-top: 1rem;">Supporting Equipment</h5>
          <div id="supportEquipment" style="font-size: 0.9rem;">
            <div>‚Ä¢ Dump trucks: <span id="truckCount">2-3 units</span></div>
            <div>‚Ä¢ Compactor: <span id="compactorType">Vibratory roller</span></div>
            <div>‚Ä¢ Grader: <span id="graderNeed">If finish grading required</span></div>
          </div>
        </div>

        <div class="soil-analysis">
          <h4>Soil Analysis & Factors</h4>
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; font-size: 0.9rem;">
            <div>
              <strong>Soil Difficulty Factor</strong>
              <div id="soilFactor">1.2x</div>
            </div>
            <div>
              <strong>Swell Factor</strong>
              <div id="swellFactor">1.25x</div>
            </div>
            <div>
              <strong>Compaction Factor</strong>
              <div id="compactionFactor">0.90x</div>
            </div>
            <div>
              <strong>Weather Factor</strong>
              <div id="weatherFactor">1.0x</div>
            </div>
          </div>
          
          <div style="margin-top: 1rem;" id="soilNotes">
            <strong>Notes:</strong> <span id="soilAdvice">Standard loam conditions with normal compaction requirements.</span>
          </div>
        </div>

        <div style="display: flex; gap: 0.5rem; margin-top: 1.5rem; flex-wrap: wrap;">
          <button class="btn btn-primary" onclick="saveCalculation()" data-action="save">üíæ Save</button>
          <button class="btn btn-secondary" onclick="exportExcavationPlan()" data-action="export">üìä Export Plan</button>
          <button class="btn btn-secondary" onclick="shareCalculation()">üîó Share</button>
          <button class="btn btn-secondary" onclick="window.print()" data-action="print">üñ®Ô∏è Print</button>
        </div>
      </div>
    </div>

    <div class="disclaimer">
      <strong>‚ö†Ô∏è Important:</strong> This provides rough order of magnitude (ROM) estimates only. Actual excavation costs vary significantly based on soil conditions, local regulations, and site-specific factors. Always get professional soil testing and quotes from qualified contractors.
    </div>

    <details style="margin-top: 2rem; padding: 1rem; background: #f7fafc; border-radius: 8px;">
      <summary style="cursor: pointer; font-weight: bold;">üìê Calculation Methodology</summary>
      <div style="margin-top: 1rem;">
        <h4>Excavation Calculations:</h4>
        <ul>
          <li><strong>Cut Volume:</strong> Length √ó Width √ó Depth √∑ 27 = Cubic Yards</li>
          <li><strong>Swell Factor:</strong> Excavated soil volume increases 15-40% when disturbed</li>
          <li><strong>Compaction Factor:</strong> Fill material compacts 5-15% from loose volume</li>
          <li><strong>Equipment Productivity:</strong> Based on soil type, equipment size, and conditions</li>
          <li><strong>Cost Factors:</strong> Include difficulty multipliers for access, weather, and soil type</li>
        </ul>
      </div>
    </details>
  </div>

  <script src="/assets/js/calculator-core.js" defer></script>
  <script src="/assets/js/calculators.js" defer></script>
  <script src="/assets/js/export-utilities.js" defer></script>
  <script src="/assets/js/calculators-hub.js" defer></script>
  <script>
    const calc = new ProCalculator('excavation');
    
    // Excavation data and factors
    const excavationData = {
      // Soil difficulty factors (affects time and cost)
      soilFactors: {
        sand: {difficulty: 0.8, swell: 1.15, compaction: 0.95},
        loam: {difficulty: 1.0, swell: 1.25, compaction: 0.90},
        clay: {difficulty: 1.4, swell: 1.35, compaction: 0.85},
        hardpan: {difficulty: 2.0, swell: 1.45, compaction: 0.80},
        rock: {difficulty: 3.5, swell: 1.60, compaction: 0.75},
        mixed: {difficulty: 1.6, swell: 1.30, compaction: 0.88}
      },
      
      // Equipment productivity (cubic yards per hour)
      equipmentProductivity: {
        sand: {small: 80, medium: 120, large: 180},
        loam: {small: 60, medium: 100, large: 150},
        clay: {small: 40, medium: 70, large: 110},
        hardpan: {small: 25, medium: 45, large: 80},
        rock: {small: 15, medium: 30, large: 60},
        mixed: {small: 35, medium: 60, large: 100}
      },
      
      // Cost factors (base cost per cubic yard)
      baseCosts: {
        excavation: 8.50, // per cubic yard
        hauling: 0.50, // per cubic yard per mile
        compaction: 2.25, // per cubic yard
        material: 18.00 // per cubic yard delivered
      },
      
      // Multipliers for conditions
      moistureFactors: {dry: 0.9, normal: 1.0, wet: 1.3, saturated: 1.8},
      accessFactors: {easy: 1.0, moderate: 1.2, difficult: 1.5, very_difficult: 2.0},
      weatherFactors: {ideal: 0.95, normal: 1.0, poor: 1.3, winter: 1.6},
      compactionFactors: {none: 0, light: 1.0, standard: 1.5, heavy: 2.5}
    };

    function calculate() {
      // Get all inputs
      const projectType = document.getElementById('projectType').value;
      const length = parseFloat(document.getElementById('length').value) || 0;
      const width = parseFloat(document.getElementById('width').value) || 0;
      const cutDepth = parseFloat(document.getElementById('cutDepth').value) || 0;
      const fillArea = parseFloat(document.getElementById('fillArea').value) || 0;
      const fillHeight = parseFloat(document.getElementById('fillHeight').value) || 0;
      const soilType = document.getElementById('soilType').value;
      const moistureContent = document.getElementById('moistureContent').value;
      const rockContent = parseFloat(document.getElementById('rockContent').value) || 0;
      const slopeRequirement = document.getElementById('slopeRequirement').value;
      const accessDifficulty = document.getElementById('accessDifficulty').value;
      const haulDistance = parseFloat(document.getElementById('haulDistance').value) || 0;
      const compactionRequired = document.getElementById('compactionRequired').value;
      const weatherConditions = document.getElementById('weatherConditions').value;

      // Calculate volumes
      const cutArea = length * width;
      const cutVolumeBank = (cutArea * cutDepth) / 27; // Bank cubic yards
      const fillVolumeCompacted = (fillArea * fillHeight) / 27; // Compacted cubic yards
      
      // Apply soil factors
      const soilData = excavationData.soilFactors[soilType];
      const cutVolumeLoose = cutVolumeBank * soilData.swell;
      const fillVolumeLoose = fillVolumeCompacted / soilData.compaction;
      
      // Calculate soil balance (excess if positive, shortage if negative)
      const soilBalance = cutVolumeBank - fillVolumeCompacted;
      
      // Total excavation volume (for equipment sizing)
      const totalExcavationVolume = cutVolumeBank;
      const totalVolume = Math.max(cutVolumeLoose, fillVolumeLoose);

      // Equipment sizing and productivity
      const equipmentSize = totalExcavationVolume < 50 ? 'small' : 
                           totalExcavationVolume < 200 ? 'medium' : 'large';
      const baseProductivity = excavationData.equipmentProductivity[soilType][equipmentSize];
      
      // Apply condition factors
      const moistureFactor = excavationData.moistureFactors[moistureContent];
      const accessFactor = excavationData.accessFactors[accessDifficulty];
      const weatherFactor = excavationData.weatherFactors[weatherConditions];
      const rockFactor = 1 + (rockContent / 100 * 0.5); // 50% productivity reduction per 100% rock
      
      const adjustedProductivity = baseProductivity / (moistureFactor * accessFactor * weatherFactor * rockFactor);
      const estimatedHours = totalExcavationVolume / adjustedProductivity;

      // Cost calculations
      const excavationCost = totalExcavationVolume * excavationData.baseCosts.excavation * soilData.difficulty * moistureFactor;
      const equipmentHours = Math.ceil(estimatedHours);
      const equipmentRate = equipmentSize === 'small' ? 85 : equipmentSize === 'medium' ? 125 : 175;
      const equipmentCost = equipmentHours * equipmentRate * accessFactor;
      
      const haulingVolume = Math.abs(soilBalance) > 0 ? Math.abs(soilBalance) : 0;
      const haulingCost = haulingVolume * excavationData.baseCosts.hauling * haulDistance;
      
      const compactionCost = fillVolumeCompacted * excavationData.baseCosts.compaction * 
                            excavationData.compactionFactors[compactionRequired];
      
      // Material cost (if fill shortage)
      const materialCost = soilBalance < 0 ? Math.abs(soilBalance) * excavationData.baseCosts.material : 0;
      
      const restorationCost = (cutArea / 43560) * 500; // $500 per acre restoration
      const premiumCost = excavationCost * (weatherFactor - 1 + accessFactor - 1);
      
      const totalCost = excavationCost + equipmentCost + haulingCost + compactionCost + 
                       materialCost + restorationCost + premiumCost;

      // Equipment recommendations
      const equipmentNames = {
        small: 'Compact Excavator (8-12 ton)',
        medium: 'Standard Excavator (15-20 ton)', 
        large: 'Large Excavator (25+ ton)'
      };
      
      const truckCount = Math.max(1, Math.ceil(adjustedProductivity / 40)); // 40 cy per truck per hour

      // Update display
      document.getElementById('totalVolume').textContent = totalExcavationVolume.toFixed(0) + ' cu yd';
      document.getElementById('volumeDetails').textContent = `Cut: ${cutVolumeBank.toFixed(0)} cy, Fill: ${fillVolumeCompacted.toFixed(0)} cy`;
      document.getElementById('totalCost').textContent = '$' + totalCost.toFixed(0);

      // Cut/fill analysis
      document.getElementById('cutVolume').textContent = cutVolumeBank.toFixed(0) + ' cu yd';
      document.getElementById('fillVolume').textContent = fillVolumeCompacted.toFixed(0) + ' cu yd';
      document.getElementById('soilBalance').textContent = soilBalance.toFixed(0) + ' cu yd';
      document.getElementById('balanceNote').textContent = soilBalance > 0 ? 'Excess material to haul away' : 
                                                         soilBalance < 0 ? 'Material shortage - import needed' : 'Balanced cut/fill';

      // Cost breakdown
      document.getElementById('excavationCost').textContent = '$' + excavationCost.toFixed(0);
      document.getElementById('equipmentCost').textContent = '$' + equipmentCost.toFixed(0);
      document.getElementById('haulingCost').textContent = '$' + haulingCost.toFixed(0);
      document.getElementById('compactionCost').textContent = '$' + compactionCost.toFixed(0);
      document.getElementById('restorationCost').textContent = '$' + restorationCost.toFixed(0);
      document.getElementById('materialCost').textContent = '$' + materialCost.toFixed(0);
      document.getElementById('premiumCost').textContent = '$' + premiumCost.toFixed(0);

      // Equipment recommendations
      document.getElementById('primaryEquipment').textContent = equipmentNames[equipmentSize];
      document.getElementById('equipmentSize').textContent = equipmentSize + ' class';
      document.getElementById('productivity').textContent = adjustedProductivity.toFixed(0) + ' cu yd/hour';
      document.getElementById('estimatedTime').textContent = estimatedHours.toFixed(1) + ' hours';
      
      document.getElementById('truckCount').textContent = truckCount + ' units';
      document.getElementById('compactorType').textContent = compactionRequired === 'none' ? 'Not required' :
        compactionRequired === 'light' ? 'Plate compactor' : 
        compactionRequired === 'standard' ? 'Vibratory roller' : 'Heavy roller + moisture';

      // Soil factors display
      document.getElementById('soilFactor').textContent = soilData.difficulty.toFixed(1) + 'x';
      document.getElementById('swellFactor').textContent = soilData.swell.toFixed(2) + 'x';
      document.getElementById('compactionFactor').textContent = soilData.compaction.toFixed(2) + 'x';
      document.getElementById('weatherFactor').textContent = weatherFactor.toFixed(1) + 'x';

      // Soil advice
      let advice = `${soilType.charAt(0).toUpperCase() + soilType.slice(1)} soil with ${moistureContent} moisture. `;
      if (rockContent > 20) advice += 'High rock content will slow progress. ';
      if (accessDifficulty !== 'easy') advice += 'Limited access increases costs. ';
      if (weatherConditions !== 'ideal') advice += 'Weather conditions may cause delays.';
      
      document.getElementById('soilAdvice').textContent = advice;

      // Save to calculator object
      calc.inputs = { 
        projectType, length, width, cutDepth, fillArea, fillHeight, soilType,
        moistureContent, rockContent, slopeRequirement, accessDifficulty,
        haulDistance, compactionRequired, weatherConditions
      };
      calc.results = { 
        totalVolume: totalExcavationVolume.toFixed(0),
        totalCost: totalCost.toFixed(0),
        soilBalance: soilBalance.toFixed(0),
        estimatedHours: estimatedHours.toFixed(1)
      };
    }

    function loadDefaults(type) {
      if (type === 'foundation') {
        document.getElementById('projectType').value = 'foundation';
        document.getElementById('length').value = '40';
        document.getElementById('width').value = '30';
        document.getElementById('cutDepth').value = '8';
        document.getElementById('soilType').value = 'loam';
        document.getElementById('compactionRequired').value = 'standard';
      } else {
        document.getElementById('projectType').value = 'grading';
        document.getElementById('length').value = '200';
        document.getElementById('width').value = '100';
        document.getElementById('cutDepth').value = '2';
        document.getElementById('fillArea').value = '5000';
        document.getElementById('fillHeight').value = '1';
      }
      calculate();
    }

    function loadLastUsed() {
      if (calc.loadLastUsed()) {
        Object.keys(calc.inputs).forEach(key => {
          const element = document.getElementById(key);
          if (element) element.value = calc.inputs[key];
        });
        calculate();
      }
    }

    function saveCalculation() {
      calc.saveCalculation();
    }

    function exportExcavationPlan() {
      calc.exportCSV();
    }

    function shareCalculation() {
      calc.shareLink();
    }

    // Auto-calculate when inputs change
    document.addEventListener('input', calculate);
    document.addEventListener('change', calculate);

    // Load from URL if shared
    window.onload = function() {
      if (calc.loadFromURL()) {
        Object.keys(calc.inputs).forEach(key => {
          const element = document.getElementById(key);
          if (element) element.value = calc.inputs[key];
        });
      }
      calculate();
    };
  </script>
</main>
<script defer>
    document.getElementById('btn-print')?.addEventListener('click', () => window.print());
</script>
<script src="/assets/js/ga-init.js" defer></script>
</body>
</html>